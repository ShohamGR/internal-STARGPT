from os.path import join
from pandas import DataFrame, Series

from tabstar2.utils.datasets import load_csv
from tabstar2.utils.images import download_url_image_column
from tabstar_paper.datasets.curation_objects import CuratedTarget, CuratedFeature
from tabstar_paper.datasets.objects import SupervisedTask, FeatureType



'''
Dataset Name: hikageshinomori/walmart-e-commerce-product-data/
====
Examples: 499
====
URL: https://www.kaggle.com/hikageshinomori/walmart-e-commerce-product-data
====
Description: 
This dataset provides a comprehensive overview of Walmart's e-commerce products, encompassing various aspects crucial for data analysis and machine learning applications. It includes information such as product titles, URLs, brands, main images, SKUs, descriptions, GTIN-13 codes, models, currency, prices, available delivery methods, primary categories, sub-categories, additional images, specifications, directions for use, ingredients, average ratings, review counts, unique IDs, and timestamps for when the data was scraped. This rich dataset is ideal for projects involving product recommendation systems, price comparison tools, and consumer behavior analysis.
====
Target Variable: price (object, 3 distinct): ['10-30$', 'Up to 10$', 'More than 30$']
====
Features:

title (object, 500 distinct): ['Nuventin Anti-Wrinkle Retinol Cream with Hyaluronic Acid and Green Tea.  Anti-Aging Cream with Retinol for Wrinkles, Fine Lines, Dry Skin. 15 fl oz', 'DURASACK 48-Gallon Green Outdoor Polypropylene Reusable Lawn and Leaf Bag (1-Pack)', 'CE003-03-2 Ring sling Air-O size 2 AQUA Baby carrier', 'Monster Energy Java Monster Mean Bean, Coffee + Energy Drink, 15 Ounce (Pack Of 12)', 'Comforter set matching fitted sheet set and pillow sham plushie toy twin size butterfly blue bag print design supersoft for girls, boys bedroom décor', 'Bestgoods Large Capacity Stroller Straps Included Waterproof Backpack Diaper Bags, Green', 'YOLAI Baby Food Supplement Grinding Bowl Manual Food Grinder Baby Food Supplement', 'Bug Zapper, Electronic LED Mosquito Zappers Killer Insect Fly Trap, Waterproof Bug Zapper for Indoor and Outdoor Patio Backyard，Wall Mounted,C13', 'Amuver Household Stainless Steel Soup Spoon Round Head Large Gold Spoons', 'Winfun Multi Color Grow With Me Melody Gym - Girl or Boy Item']
brand (object, 414 distinct): ['Generic', 'Oral-B', 'Schick', 'Revlon', 'Kleenex', 'Gillette', "Mrs. Meyer's Clean Day", 'Downy', 'Bestgoods', 'Clorox']
main_image (object, 499 distinct): ['https___i5.walmartimages.com_asr_2961b7bc-950d-49a6-a8c0-922097999329.a7ba95aa156ae09e458cebe026db4ae1.jpeg', 'https___i5.walmartimages.com_asr_5ba35a83-3568-4627-8276-ad43f7922fd4.0d649025bf2ea3301f2669663c24375a.jpeg', 'https___i5.walmartimages.com_asr_082b1355-6183-41e8-800f-325c24df3ae1_1.f4925b8e500ee04d1c4cf3e943c9c49a.jpeg', 'https___i5.walmartimages.com_asr_58add095-ed57-42ad-b007-a265bb3e9be7.2ee89a16dbf26d052da90657ec7a149f.jpeg', 'https___i5.walmartimages.com_asr_7a30a6ad-0d93-445d-859d-8a723e729f6d.ae9e46499e1a2b94cf88f6991ed31923.jpeg', 'https___i5.walmartimages.com_asr_21cfd9f7-f2d9-4979-8f2d-a2dfa81d6bc6.f4891e3703d3a44988acad2a11ec3a9b.jpeg', 'https___i5.walmartimages.com_asr_db2c0e3a-d24d-4568-a189-f18580a2f6c5.65e7c6de12c7f86f4d698369afd3288c.jpeg', 'https___i5.walmartimages.com_asr_61819ae4-1536-48f3-9369-829a79cf82e9.44cd8ae23ecb21a72e92362239e9a7e4.jpeg', 'https___i5.walmartimages.com_asr_7186b962-df86-4bc7-9e57-f27bbedc0477_1.0294c01349af803966785e21b6f75d0c.jpeg', 'https___i5.walmartimages.com_asr_93a766ce-5237-4b15-8143-61b27e35cc62.259584f4c5ed047808a5bb130a10bb13.jpeg']
description (object, 491 distinct): ['short description is not available', '<p>\n    <b><i>L10 Subject:</i></b>\n</p>\n<p>\n    Rated power: 5w <br>\n    Water tank capacity: 300ml <br>\n    Water pressure rating: 30-90 psi <br>\n    Working mode: clean/pulse/surf <br>\n    Pulse frequency: 1600-1800 times per minute\n</p>\n<p>\n    <i><b>Package Including:</b></i>\n</p>\n<p>\n    \n        1pcs 5pcs Jet Tips 1pcs \n        Oral Irrigator Machine \n    <br>\n    1pcs USB Line 1pcs <br>\n    User Manual\n</p>\n<p>\n    <i><b>1000 times \\ min power cleaning frequency spray</b></i>\n</p>\n<p>\n    Effectively remove dental plaque, deeply the celan teeth gap and other parts that is hard to reach\n</p>\n<p>\n    <i><b>5 tips for different usage</b></i>\n</p>\n<p>\n    There are 4 types of nozzles to meet your different needs: <br>\n    Standard Nozzle Nozzle x 2 <br>\n    ● Orthodontic Nozzle x1 <br>\n    Nozzle Tongue Demolition Nozzle x1 <br>\n    ● Perionontal Nozzle x1\n</p>\n<p>\n    <i><b>how to clean teeth</b></i><br>\n</p>\n<p>\n    1. Insert tip <br>\n    2. Fill with water <br>\n    3. Long press 3s the power button to turn on (off) <br>\n    4. Press the power button to select suitable clean modes\n</p>\n<p>\n    <b><i>Product Details:</i></b><br>\n</p>\n<p>&nbsp;Charging T    ime: 4-6h</p>\n<p>UsageTime            ; 5minutes        </p>\n<p>Battery Capacity            : 800MAH        </p>\n<p>Battery Model            : 14500 lithium ion battery        </p>\n<p>Certified Product            : CE FCC ROHS FDA        </p>\n<p>Product Dimensions<b> \u200f : \u200e</b><b>&nbsp;</b>9.8    &nbsp;x 7.8&nbsp;x 22.5    &nbsp;cm</p>\n<p>&nbsp;</p>\n<p>\n    <br>\n</p>', "Butts Deserve Better™\n Hypoallergenic & plant-based flushable wipes are perfect for any time of the day, that time of the month, noon and night, 365 days out of the year. Who doesn't like to stay fresh down there? Does toilet paper really make you feel clean? Add these to your daily routine for quick, soothing refreshment! Each wipe is suitable for front or back! =) So level up and treat your butt right. Because you're a Massterpiece™", 'Unknown Value', "<p>Fairywill is a brand about family, friends and caring. Fairywill D8 adults toothbrush set - The toothbrush set is an affordable pack of 2 designed for multiple users, now everyone's oral health can enjoy a cooler, cleaner care, and share the benefits of ultra powerful clean with a 2-min build-in smart timer to always deliver the best results. Suitable for families, especially for couples. Designed for Adults and kids beyond 8. We combine fashion with efficient cleaning to bring the best oral care tools.</p><p>This Fairywill power toothbrush for adults is ADA Accepted. The ADA is the professional association of dentists dedicated to serving both the public and the profession of dentistry. The ADA promotes the public's health through commitment of member dentists to provide quality oral health care, accessible to everyone. Fairywill always works to give you the highest level of quality and care, that is why we associate ourselves with the best and work to give you the best.</p>", "L'ENVOL DE CARTIER/CARTIER SHOWER GEL 6.7 OZ (200 ML) (M)", 'Feature:&lt;br&gt;1. The laundry balls is made of high quality TPR material with high strength and high resilience. Environmental protection, non-toxic, soft texture, no harm to clothing. &lt;br&gt;2. There are several special ceramic particles inside, which can enhance the decontamination ability.&lt;br&gt;3. Compatible with any washing machine, it can wash all kinds of clothes. It&amp;#39;s cheaper than detergent and bleach, and milder for sensitive skin.&lt;br&gt;4. Reduce incrustation scale, rust and lime accumulation in washing machines and pipes. And remove dirt, oil and odor.&lt;br&gt;5. In order to improve the cleaning efficiency, it is necessary to put the laundry balls in the sun for several hours each month. Do not put the laundry ball into the dryer.&lt;br&gt;Specification:&lt;br&gt;Diameter: 11cm&lt;br&gt;Notice:&lt;br&gt;1.Due to the different monitor and light effect, the actual color may be a slightly different from the picture color.&lt;br&gt;2.Please allow 1-3cm differs due to manual measurement.', "<p>The Albolene Gumdrop Newborn Pacifier makes it easier to soothe your baby. It's free of BPA to be safer for young children to use. You get two baby pacifiers per pack to have an extra on hand.</p>", "&lt;p&gt;Product details&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;The premium wool dryer balls for static are a green, energy saving laundry drying solution. Wool dryer ball is an economic alternative for chemicals dryer sheets, liquid fabric softener and one-time use products; it provides a safe, sustainable and healthy\n    life for your family.&lt;/p&gt;\n&lt;p&gt;FAQ&lt;/p&gt;\n&lt;p&gt;1. Still get static after using these wool balls?&lt;/p&gt;\n&lt;p&gt;Answer: One cause of static is over drying, you can pull the balls just a little early or put a little essential oil on the balls.&lt;/p&gt;\n&lt;p&gt;Another cause of static is synthetic materials like polyester, nylon, rayon and acrylic. You may notice polyester or nylon loads are the worst! Try to separate synthetics to keep the rest of your laundry static-free. Then either dry the synthetics by\n    hanging them on a line or in the dryer, making sure you end the drying cycle before they are totally dry.&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Package Including: 1*Wool Dryer Ball&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;All natural, Made from 100% New Zealand Wool&lt;/p&gt;\n&lt;p&gt;Organic dryer balls- Reusable Natural Fabric Softener.&lt;/p&gt;\n&lt;p&gt;Natural wool dryer balls, no chemicals, no fillers, no allergy, unscented.&lt;/p&gt;\n&lt;p&gt;Hypoallergenic dryer balls are safe for babies, the aged &amp;amp; anyone who has sensitive skin.&lt;/p&gt;\n&lt;p&gt;Reusable dryer balls reduce harmful chemicals to environment!&lt;/p&gt;\n&lt;p&gt;Extra Large dryer balls, a little larger than a tennis ball.&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Household Tips for Time and Money Savings&lt;/p&gt;\n&lt;p&gt;No repeated cost for chemical fabric softener, wool dryer balls can be used over 1500 times, typically last 2-3 years.&lt;/p&gt;\n&lt;p&gt;Dryer balls for laundry reduce 15%-25% drying time by circulating hot air between the wet items.Reduce your need to iron clothes and prevent static cling.&lt;/p&gt;\n&lt;p&gt;Organic dryer balls won't harm your dryer machine, no chemical residues.&lt;/p&gt;\n&lt;p&gt;Better Laundry Time&lt;/p&gt;\n&lt;p&gt;Wool dryer balls naturally soften clothing, towels, sheets and blankets without chemicals.&lt;/p&gt;\n&lt;p&gt;Enjoy soft, fluffy, fragrant clothes with your family.&lt;/p&gt;\n&lt;p&gt;Effectively reducing wrinkles, static cling, twisting, tangling, lint &amp;amp; pet hair!&lt;/p&gt;\n&lt;p&gt;Wool dryer balls bounce around in your dryer machine gentlely, it is lower bouncing noise than plastic balls.&lt;/p&gt;\n&lt;p&gt;How do dryer balls work?&lt;/p&gt;\n&lt;p&gt;1. Place 3-4 pcs organic wool dryer balls for small or medium load, 5- 6 pcs for large load.&lt;/p&gt;\n&lt;p&gt;2. Put 1-2 drops of essential oil to get wonderful smell of your laundry.&lt;/p&gt;\n&lt;p&gt;3. Over-drying may increase static cling, try to set shorter time or use moisture-sensitive setting to prevent static cling.&lt;/p&gt;\n&lt;p&gt;Tips&lt;/p&gt;\n&lt;p&gt;Drying ball provides a fun toy for your pets and it is safe for them.&lt;/p&gt;\n&lt;p&gt;Give your clothes a wonderful scent by adding your favorite lavender or tea tree essential oils to dryer balls (essential oil not included).&lt;/p&gt;\n&lt;p&gt;Pack of 6 laundry dryer balls is a considerate gift for Baby showers, Mother's day, Christmas, Housewarming.&lt;/p&gt;\n&lt;p&gt;Natural wool dryer balls are also suitable for Laundromats, apartments, dorms, and hotels.&lt;/p&gt;\n&lt;p&gt;Try pinning a small safety pin on one ball to diffuse static.&lt;/p&gt;", '<p><b>Description:</b></p><p>Chocolate Candy Foil Wrappers, Good Decoration for Your DIY Handmade Craft<br></p><p>Food grade material aluminum foil paper, friendly, non-, tasteless; Easy to wrap, hold their shape </p><p>Perfect for Christmas, party, wedding and daily life wrappers for multifarious candies, like confections, chocolate, sweets, dessert, tea leaves etc.</p><p>Material: Aluminum Foil Paper</p><p>Dimension: 16 x 16cm / 6.3x 6.3inch</p><p><b>Package Includes:</b></p><p>100 Pieces Chocolate Candy Foil Wrappers</p><p><b>Note:</b></p><p>1. Color might be slightly different due to the color calibration of each individual monitor.</p><p>2. Please allow the tinny measuring deviation due to manual measurement.</p><p>3. This product cannot be  high temperature, please do not  the microwave or bake in the oven.</p>']
primary_category (object, 19 distinct): ['Household Essentials', 'Personal Care', 'Baby', 'Beauty', 'Food', 'Home', 'Pets', 'Premium Beauty', 'Industrial & Scientific', 'Auto & Tires']
sub_category_1 (object, 72 distinct): ['Paper & Plastic', 'Oral Care', 'Bath & Body', 'Laundry', 'Cleaning Supplies', 'Shaving', 'Pest Control', 'Beverages', 'Air Fresheners', 'Household Essentials by Brand']
sub_category_2 (object, 204 distinct): ['Disposable Tableware', 'Tea', 'Unknown Value', 'Razors', 'Hand Creams', 'Electric Toothbrushes', 'Wax and Parchment Paper', 'Hand Soaps', 'Insect & Pest Baits', 'Drain Cleaners']
directions (object, 99 distinct, 78.8% missing): ['Hand Wash', 'Machine Washable; Hand Wash', 'Wipe Clean', 'Use as an alternative to toilet paper.', 'Good Product', 'How to replace your AA battery: 1. Twist battery cap to the left. 2. Insert new AA battery. Toothbrush will turn on, indicating proper battery insertion. 3. Twist battery cap to the right until tightly sealed.', 'Clean the skin thoroughly before applying this product.Cover the entire affected area with a thin layer one to three times daily.Because excessive drying of the skin may occur, start with one application daily, then gradually increase to two or three times daily if needed or as directed by a doctor.If bothersome dryness or peeling occurs, reduce application to once a day or every other day.Sensitivity Test for a New User: Apply product sparingly to one or two small affected areas during the first 3 days. If no discomfort occurs, follow the directions stated above.  Other informationStore at room temperature.  Questions? 800-582-4048; outside US, dial collect 215-273-8755 or visit www.neutrogena.com', "Moisten your hands, then add a pump of Mrs. Meyer's Clean Day Liquid Hand Soap. The longer you rub your hands, the cleaner they become.", 'Use as Instructed', '*gentle cycle *tumble dry low *do not bleach *do not wring or twist *do not iron']
ingredients (object, 93 distinct, 80.8% missing): ['essential', 'Active Ingredient  Sulfur 10%  Purpose  Acne TreatmentInactive Ingredients Isopropyl Alcohol, Water, Calamine, Niacinamide, Zinc Oxide, Zea Mays (Corn) Starch, Magnesium Aluminum Silicate, Salicylic Acid, Titanium Dioxide', 'Aloe Barbadensis Leaf Juice; Water (Aqua); Yucca Schidigera Root Extract; Hamamelis Virginiana (Witch Hazel); Rosa Damascena Flower Water; Glycol (Glycerin); Cocamidopropyl Betaine; Coco-Glucoside; Sodium Lauroyl Oat Amino Acids (Foaming Oats); Sambucus Nigra (Elderberry) Fruit Extract;\nDecyl Glucoside; Polyglyceryl-10 Caprylate/Caprate; Glyceryl Oleate; Guar (Gum) Hydroxypropyltrimonium Chloride; Lavandula Angustifolia (Lavender) Oil; Melaleuca Alternifolia (Tea Tree) Leaf Oil; Benzyl Alcohol; Salicylic Acid; Sorbic Acid; Sodium Phytate; Tocopherol (Vitamin E)', 'Ethyl Alcohol 70%. Water (Aqua), Caprylyl Glycol, Denatonium Benzoate, Glycerin, Isopropyl Myristate, t-Butyl Alcohol, Tpcopheryl Acetate, Acrylates/C10-30, Alkyl Acrylate Crosspolymer, Aminomethyl Propanol, Fragrance (Parfum)', 'Water (Aqua) Mineral Oil Cetearyl Alcohol Glyceryl Stearate SE Isopropyl Myristate Glycerin Butylene Glycol Ceteareth-20 Caprylic/Capric Triglyceride Retinol Aloe Barbadensis Leaf Juice Camellia Sinensis Leaf Extract Anthemis Nobilis Flower Extract Acrylates/C10-30 Alkyl Acrylate Crosspolymer Disodium EDTA Maltodextrin Phenoxyethanol Iodopropynyl Butylcarbamate Caprylyl Glycol Sodium Hydroxide', 'Water, Sodium Stearate, Fragrance, Glyceryl Stearate, Glycerin, Sodium Chloride, Sodium Bicarbonate', 'Bromo-1-chloro-5,5-dimethylhydantoin, dichlorodimethyl hydantoin, dichloroethylmethyl hydantoin, sodium chloride', 'Beefhide,Chicken,Vegetable Glycerin,Sugar,Salt,Sorbitol (A Preservative)', 'Water, Cocamidopropyl Hydroxysultaine, Sodium Methyl 2-Sulfolaurate, Glycerin, Juniperus Virginiana Oil, Citrus Aurantium Dulcis (Orange) Peel Oil, Fragrance, (Coumarin, Hydroxycitronellal), Avena Sativa (Oat) Kernal Extract, Olea Europaea (Olive) Fruit Oil, Aloe Barbadensis Leaf Juice, Citric Acid, Sodium Chloride, Potassium Sorbate', 'Active ingredientAluminum chloride 14%Inactive ingredientsWater, botanical extracts, polyethylene glycol 8000, polysorbate 20, vitamin E oil, eugenol.']
avg_rating (float64, 23 distinct, 51.4% missing): ['5.0', '4.6', '4.7', '4.5', '4.8', '4.4', '4.3', '4.0', '4.9', '3.0']
reviews_count (float64, 105 distinct, 51.4% missing): ['1.0', '2.0', '5.0', '3.0', '4.0', '8.0', '11.0', '9.0', '7.0', '14.0']
image_count (int64, 18 distinct): ['2', '1', '8', '3', '7', '6', '5', '9', '4', '10']
first_img (object, 431 distinct, 13.4% missing): ['https___i5.walmartimages.com_asr_d4174e60-854b-400c-a6d6-050f9eead1b0.dc364e3f9400028e074ce962c9eb7e9d.jpeg', 'https___i5.walmartimages.com_asr_4371e774-822b-41e9-b516-1564f4d27955.1900855e75fcd13a0d20aaf987e9effa.jpeg', 'https___i5.walmartimages.com_asr_768b201a-ce8a-4c9f-bb29-7685fce3ac3d.97886308aacee5aa6666b7c2ba332f48.jpeg', 'https___i5.walmartimages.com_asr_d80a23f7-8605-4ec6-af25-45284257b8c6.fe4b6991a8ab323a15f035642ceca154.jpeg', 'https___i5.walmartimages.com_asr_ac092581-fed5-4749-8618-1ff2e1148e94.53f55a3f9b4e9a6d384ffeba4f68041a.jpeg', 'https___i5.walmartimages.com_asr_8a80eb85-3563-4b4d-9cde-40825bb3e3d7.6963e3db40a940b299633e2abb03f4df.jpeg', 'https___i5.walmartimages.com_asr_923a0b97-170d-4d1d-9ec9-f70c8dd94697.d15312144fd2ac8550ef3b79c60630df.jpeg', 'https___i5.walmartimages.com_asr_30d6631d-9a21-41f1-855a-74db322bae93.d56c6bf6539a615a2ef4f1926492183b.jpeg', 'https___i5.walmartimages.com_asr_5bcb37fc-bf92-4f30-9775-4c3739cd9a6f.3321a788bfdec91ebb07501deeca5a6e.jpeg', 'https___i5.walmartimages.com_asr_638b036d-4979-475b-98d4-b5816ff0d555_1.4b661bcc9488c6ab27d080440af721be.jpeg']
second_img (object, 360 distinct, 27.6% missing): ['https___i5.walmartimages.com_asr_c1c8bf75-c793-468b-80e2-95b69a82f436.06f562b568848b1c29299817e8e81a7b.jpeg', 'https___i5.walmartimages.com_asr_772bb56f-fed5-4405-b1be-483280fa1d55.b97f53523a2725e1e50704c666bc7880.jpeg', 'https___i5.walmartimages.com_asr_09608f50-eff3-4080-8579-3e6017fa7a5d.17ad6ee3213d24f08a96e390b6cba2b8.jpeg', 'https___i5.walmartimages.com_asr_8a0555cb-9a1a-4b92-a866-607b0a761ead.3257c100a738f29eb8f8b4fb97acbae7.jpeg', 'https___i5.walmartimages.com_asr_be80c5a5-10de-48ed-a26b-b97dfeeb31c1.e6a172f1e747d65dceffaaf2be73515e.jpeg', 'https___i5.walmartimages.com_asr_d5769912-ca4f-4027-8e83-bf4bd8ae296e.9ecb104ef4ee76f8475d18c26622b28d.jpeg', 'https___i5.walmartimages.com_asr_e93de74b-886d-4756-a39c-fe8fa48cd0f3.d3f8c025fc3facb664f46f716337339d.jpeg', 'https___i5.walmartimages.com_asr_b1a1f1a9-0baa-43d0-84c9-56006065e6b9.6c9b659adc3a49477e196610ed2aa7d9.jpeg', 'https___i5.walmartimages.com_asr_eaa5831e-d73a-4d92-97d6-2759dbe17888.bbaefe0c64a24496e47a8ada40ed9d57.png', 'https___i5.walmartimages.com_asr_285cf811-a59d-431e-b728-19d99d9e9d88.f620c1f62f474562e99cd1e27421ba31.jpeg']
'''

PRICE = "price"
MAIN_IMG = "main_image"
FIRST_IMG = "first_img"
SECOND_IMG = "second_img"


# Relatively randomly decided to predict the price
# We could have used multiple images instead of only one.
def load_df(dir_path: str) -> DataFrame:
    df = load_csv(dir_path, "walmart.csv")
    df = handle_images(df=df, dir_path=dir_path)
    df[PRICE] = df[PRICE].apply(discretize_price)
    return df

def handle_images(df: DataFrame, dir_path: str) -> DataFrame:
    df['image_count'] = df['images'].apply(lambda s: len(s.split('~')))
    df['image_list'] = df.apply(_remove_main_image_from_images_and_take_two_more, axis=1)
    df[FIRST_IMG] = df['image_list'].apply(lambda x: x[0])
    df[SECOND_IMG] = df['image_list'].apply(lambda x: x[1])
    df.drop(columns=['image_list', 'images'], inplace=True)
    image_folder = join(dir_path, IMAGE_FOLDER)
    df = download_url_image_column(df=df, img_folder=image_folder, img_col=MAIN_IMG)
    df = download_url_image_column(df=df, img_folder=image_folder, img_col=FIRST_IMG)
    df = download_url_image_column(df=df, img_folder=image_folder, img_col=SECOND_IMG)
    return df

def _remove_main_image_from_images_and_take_two_more(r: Series):
    main_img = r[MAIN_IMG]
    images = r['images']
    assert main_img in images
    images = images.replace(main_img, "")
    image_list = [s.strip() for s in images.split('~') if s.strip()]
    padded_image_list = image_list + [None, None]
    return padded_image_list[:2]

def discretize_price(p: float) -> str:
    if p < 10:
        return "Up to 10$"
    elif p > 30:
        return "More than 30$"
    else:
        return "10-30$"

CONTEXT = "Walmart products with images and descriptions for price estimation"
TARGET = CuratedTarget(raw_name=PRICE, task_type=SupervisedTask.MULTICLASS)
COLS_TO_DROP = ['model', 'url', 'gtin13', 'uniq_id', 'scraped_at', 'currency', 'availableDeliveryMethod', 'sku', 'specifications']
TEXT_FEATURES = [CuratedFeature(raw_name=f, feat_type=FeatureType.TEXT) for f in ['brand', 'description', 'sub_category_2', 'title']]
FEATURES = [CuratedFeature(raw_name=MAIN_IMG, feat_type=FeatureType.IMAGE),
            CuratedFeature(raw_name='first_img', feat_type=FeatureType.IMAGE),
            CuratedFeature(raw_name='second_img', feat_type=FeatureType.IMAGE),] + TEXT_FEATURES
IMAGE_FOLDER = "walmart_downloaded"
LOADING_FUNC = load_df
