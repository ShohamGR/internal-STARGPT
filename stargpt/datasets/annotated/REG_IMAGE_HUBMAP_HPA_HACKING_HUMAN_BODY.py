import os
from os.path import exists, join

from pandas import DataFrame, Series

from tabstar2.utils.datasets import load_csv
from tabstar_paper.datasets.curation_objects import CuratedTarget, CuratedFeature
from tabstar_paper.datasets.objects import SupervisedTask, FeatureType


'''
Dataset Name: miquel0/hubmaphba-tiled-dataset-512x512/
====
Examples: 12581
====
URL: https://www.kaggle.com/miquel0/hubmaphba-tiled-dataset-512x512
====
Description: 
HuBMAP+HBA Tiled dataset 512x512
Tiled dataset for "HuBMAP + HPA - Hacking the Human Body" competition

About Dataset
This tiled dataset for "HuBMAP + HPA - Hacking the Human Body" competition consists of:

Tiled images directory, image name format is the following "{image_id} _ {tile_id}.png"
CSV file with data for every tile stored
CSV file consists of 12 columns:

id - The image ID.
organ - The organ that the biopsy sample was taken from.
data_source - Whether the image was provided by HuBMAP or HPA.
img_height - The height of the image in pixels.
img_width - The width of the image in pixels.
pixel_size - The height/width of a single pixel from this image in micrometers. All HPA images have a pixel size of 0.4 µm. For HuBMAP imagery the pixel size is 0.5 µm for kidney, 0.2290 µm for large intestine, 0.7562 µm for lung, 0.4945 µm for spleen, and 6.263 µm for prostate.
tissue_thickness - The thickness of the biopsy sample in micrometers. All HPA images have a thickness of 4 µm. The HuBMAP samples have tissue slice thicknesses 10 µm for kidney, 8 µm for large intestine, 4 µm for spleen, 5 µm for lung, and 5 µm for prostate.
age - The patient's age in years.
sex - The sex of the patient.
idx - The image tile id.
rle - The target column. A run length encode of the mask tile.
idxs_tile - coordinates from original image that the tile was extracted from.


====
Target Variable: organ (object, 5 distinct): ['kidney', 'prostate', 'largeintestine', 'spleen', 'lung']
====
Features:

img_height (int64, 20 distinct): ['3000', '2654', '2631', '2790', '2764', '2942', '2416', '2867', '2727', '2783']
img_width (int64, 20 distinct): ['3000', '2654', '2631', '2790', '2764', '2942', '2416', '2867', '2727', '2783']
age (float64, 28 distinct): ['57.0', '61.0', '84.0', '55.0', '65.0', '59.0', '70.0', '76.0', '21.0', '83.0']
sex (object, 2 distinct): ['Male', 'Female']
rle (object, 4871 distinct, 61.2% missing): ['1 262144', '365 148 878 147 1390 147 1903 146 2417 144 2931 142 3445 140 3957 140 4470 139 4983 138 5496 137 6010 135 6524 133 7038 131 7551 130 8064 129 8577 128 9090 127 9603 126 10116 125 10629 124 11141 124 11654 123 12167 122 12680 121 13193 120 13707 118 14220 117 14733 116 15246 115 15759 114 16272 113 16785 112 17298 111 17811 110 18323 110 18836 109 19349 108 19862 107 20375 106 20889 104 21402 103 21915 102 22428 101 22941 100 23454 99 23967 98 24480 97 24993 96 25506 95 26019 94 26531 94 27044 93 27556 93 28068 93 28581 92 29095 90 29608 89 30120 89 30633 88 31146 87 31660 85 32176 81 32688 81 33201 80 33713 80 34226 79 34739 78 35253 76 35769 72 36281 72 36794 71 37307 70 37820 69 38334 67 38848 65 39361 64 39875 62 40388 61 40900 61 41413 60 41926 59 42439 58 42952 57 43466 55 43979 54 44491 54 45004 53 45517 52 46030 51 46543 50 47055 50 47568 49 48080 49 48593 48 49105 48 49618 47 50130 47 50643 46 51156 45 51668 45 52181 44 52693 44 53205 44 53717 44 54229 44 54742 43 55255 42 55768 41 56281 40 56794 39 57307 38 57820 37 58333 36 58846 35 59359 34 59872 33 60385 32 60898 31 61411 30 61924 29 62437 28 62950 27 63462 27 63974 27 64487 26 65000 25 65513 24 66025 24 66538 23 67051 22 67565 20 68077 20 68589 20 69102 19 69614 19 70127 18 70640 17 71153 16 71666 15 72178 15 72691 14 73203 14 73716 13 74229 12 74742 11 75254 11 75767 10 76279 10 76792 9 77304 9 77816 9 78328 9 78840 9 79352 9 79865 8 80378 7 80891 6 81404 5 81917 4 82429 4 82941 4 83453 4 83965 4 84477 4 84990 3 85503 2 86016 1 146944 1 147455 2 147966 3 148477 4 148988 5 149500 5 150011 6 150521 8 151032 9 151543 10 152054 11 152565 12 153077 12 153588 13 154098 15 154609 16 155121 16 155632 17 156144 17 156655 18 156803 21 156871 15 157167 18 157313 25 157382 17 157678 19 157816 41 157872 45 158186 23 158327 43 158383 47 158697 24 158838 108 159208 25 159349 110 159719 26 159860 111 160231 26 160367 119 160739 30 160877 123 161250 31 161388 127 161759 34 161899 129 162269 36 162408 138 162780 37 162919 140 163291 38 163430 141 163803 38 163941 143 164312 41 164452 146 164822 43 164963 152 165331 46 165474 155 165842 47 165982 162 166350 51 166493 164 166861 52 167005 164 167373 52 167516 169 167882 55 168027 171 168392 57 168538 173 168899 62 169050 174 169409 64 169559 178 169918 67 170070 180 170429 68 170582 181 170941 68 171093 185 171328 20 171447 74 171604 187 171839 22 171958 75 172115 189 172317 65 172460 85 172627 191 172828 68 172970 87 173139 276 173472 97 173651 277 173983 98 174163 277 174495 98 174672 286 174994 111 175184 287 175505 112 175695 434 176207 434 176718 435 177229 436 177741 436 178252 437 178763 438 179275 438 179786 439 180290 447 180802 447 181314 447 181824 449 182336 449 182846 451 183358 451 183870 451 184381 452 184892 453 185401 456 185912 457 186423 458 186933 460 187444 461 187955 462 188467 462 188978 463 189489 464 190000 465 190510 467 191021 468 191532 469 192044 469 192555 470 193066 471 193577 472 194088 473 194600 473 195111 474 195623 474 196134 475 196646 475 197157 476 197669 476 198180 477 198692 477 199204 477 199716 477 200228 477 200740 477 201251 478 201762 479 202274 479 202786 479 203298 479 203810 479 204322 479 204832 481 205343 482 205855 482 206367 482 206879 482 207390 483 207901 484 208413 484 208925 484 209437 484 209949 484 210461 484 210973 484 211485 484 211997 484 212509 484 213020 485 213532 485 214043 486 214555 486 215067 486 215579 486 216091 486 216603 486 217115 486 217627 486 218139 486 218651 486 219163 486 219675 486 220187 486 220699 486 221211 486 221723 486 222235 486 222747 486 223259 486 223771 486 224283 486 224795 486 225307 486 225819 486 226331 486 226843 486 227355 486 227867 486 228379 486 228891 486 229403 486 229915 486 230427 486 230939 486 231451 486 231963 486 232475 486 232987 486 233499 486 234011 486 234523 486 235035 486 235547 486 236059 486 236571 486 237083 486 237595 486 238105 488 238616 489 239128 489 239640 489 240152 489 240664 489 241176 489 241688 489 242200 489 242712 489 243224 489 243736 489 244248 489 244760 489 245272 489 245784 489 246296 489 246808 489 247320 489 247832 489 248344 489 248856 489 249367 490 249879 490 250390 491 250902 491 251414 491 251926 491 252438 491 252950 491 253462 491 253974 491 254486 491 254998 491 255510 491 256022 491 256534 491 257046 491 257558 491 258070 491 258582 491 259094 491 259606 491 260118 491 260630 491 261142 491 261654 491', '127685 18 128197 18 128703 31 129209 42 129715 53 130221 65 130728 73 131237 80 131749 81 132253 95 132762 110 133268 130 133777 139 134283 148 134793 153 135305 154 135817 158 136329 168 136840 179 137353 185 137865 189 138377 192 138889 192 139401 195 139913 199 140425 201 140935 205 141446 207 141958 208 142470 209 142981 211 143493 211 144005 212 144516 217 145027 219 145539 220 146050 221 146562 222 146816 27 147074 225 147323 35 147585 227 147831 42 148097 230 148340 49 148608 294 149120 298 149631 300 150143 300 150654 303 151166 304 151677 308 152189 309 152701 311 153213 311 153724 313 154236 315 154747 317 155259 318 155770 321 156281 323 156792 325 157304 326 157816 327 158328 328 158840 330 159352 331 159863 333 160375 333 160887 335 161399 336 161911 337 162423 338 162935 340 163447 343 163959 344 164471 344 164983 345 165495 346 166007 350 166519 353 167031 357 167543 357 168055 360 168567 377 169079 383 169591 387 170103 393 170615 394 171128 393 171640 393 172152 393 172664 393 173178 391 173690 391 174203 390 174715 390 175228 389 175740 389 176253 388 176766 387 177280 385 177792 385 178305 384 178817 384 179329 384 179841 384 180354 383 180867 382 181379 382 181891 382 182403 382 182916 381 183428 381 183940 381 184453 380 184965 380 185477 380 185989 380 186501 380 187013 380 187526 379 188038 379 188550 379 189062 379 189574 379 190086 379 190598 379 191110 379 191621 380 192133 380 192645 380 193157 380 193668 381 194180 381 194692 381 195203 382 195715 227 195952 145 196227 226 196467 142 196739 226 196981 140 197250 226 197494 139 197762 222 198008 137 198274 221 198522 135 198786 217 199038 131 199298 213 199559 122 199810 212 200077 116 200322 205 200591 114 200834 203 201104 113 201346 197 201621 108 201858 193 202137 104 202370 189 202652 101 202881 187 203167 98 203393 185 203681 96 203905 185 204195 94 204417 184 204708 93 204930 181 205222 91 205442 180 205738 87 205954 179 206251 86 206467 178 206766 83 206980 176 207280 81 207495 173 207793 80 208008 171 208306 79 208521 169 208819 78 209034 166 209333 76 209547 165 209847 74 210059 165 210363 70 210572 164 210876 69 211084 163 211390 67 211597 162 211902 67 212109 161 212415 66 212622 160 212929 64 213134 160 213442 63 213646 159 213955 62 214159 158 214468 61 214671 158 214981 60 215184 157 215494 59 215696 156 216007 58 216208 156 216520 57 216721 155 217033 56 217234 154 217547 54 217746 153 218061 52 218258 153 218574 51 218770 153 219087 50 219283 152 219600 49 219795 150 220113 48 220308 149 220628 45 220820 149 221141 44 221332 149 221654 43 221845 147 222169 40 222358 146 222682 39 222871 145 223196 37 223384 143 223709 36 223896 143 224222 35 224408 142 224738 31 224921 141 225251 30 225433 141 225764 29 225946 139 226277 28 226458 139 226790 27 226970 139 227304 23 227483 137 227818 17 227995 137 228331 13 228507 136 228846 6 229020 135 229533 133 230045 132 230557 132 231070 130 231583 128 232095 127 232607 126 232840 23 233119 126 233351 25 233632 125 233863 25 234145 124 234370 39 234657 122 234880 43 235170 121 235386 55 235468 6 235682 121 235897 57 235979 8 236194 121 236406 101 236706 120 236917 103 237220 118 237429 103 237733 117 237937 113 238246 115 238448 115 238758 115 238959 117 239271 114 239470 120 239784 112 239981 122 240296 112 240492 124 240809 110 241003 125 241323 108 241512 129 241836 107 242023 131 242350 104 242534 133 242863 103 243044 137 243378 99 243555 139 243891 97 244066 141 244405 94 244578 141 244918 93 245089 143 245432 91 245600 145 245946 89 246111 147 246459 87 246623 149 246972 85 247135 152 247485 84 247647 152 247998 82 248159 152 248512 80 248670 154 249027 76 249181 155 249541 73 249692 160 250054 71 250204 160 250568 68 250716 162 251082 66 251228 163 251595 64 251740 163 252108 62 252252 165 252622 59 252765 164 253136 56 253279 162 253649 54 253791 162 254163 50 254303 162 254680 44 254815 162 255193 42 255327 162 255713 33 255840 161 256234 23 256352 161 256865 160 257378 159 257891 158 258404 157 258917 156 259430 155 259943 154 260456 153 260969 152 261482 151 261995 150', '1 124 146 107 513 124 658 107 1025 123 1170 107 1537 122 1681 108 2049 121 2192 109 2561 121 2704 109 3073 121 3215 110 3585 121 3726 111 4097 121 4237 112 4609 121 4748 113 5121 121 5260 113 5633 121 5772 113 6145 121 6284 113 6657 121 6796 113 7169 121 7308 113 7681 121 7820 113 8193 121 8331 114 8705 121 8843 114 9217 121 9355 114 9729 121 9867 114 10241 121 10379 114 10753 121 10890 115 11265 121 11402 115 11777 120 11913 116 12289 118 12425 116 12801 118 12937 116 13313 118 13449 116 13825 118 13960 117 14337 118 14471 118 14849 118 14983 118 15361 118 15495 118 15873 118 16007 118 16385 118 16519 118 16897 118 17030 119 17409 118 17542 119 17921 118 18054 119 18433 118 18566 119 18945 117 19078 119 19457 116 19590 119 19969 115 20102 119 20481 115 20613 120 20993 115 21125 120 21505 115 21636 121 22017 115 22147 122 22529 115 22659 122 23041 115 23170 123 23553 114 23682 123 24065 113 24193 124 24577 112 24705 124 25089 112 25216 125 25601 112 25728 125 26113 112 26240 125 26625 112 26752 125 27137 112 27263 126 27649 112 27775 126 27921 8 28161 112 28287 126 28433 9 28673 112 28798 127 28944 12 29185 112 29309 128 29455 19 29697 111 29820 129 29967 19 30209 110 30331 130 30478 25 30721 109 30843 130 30989 27 31233 109 31355 130 31501 28 31745 109 31867 130 32012 30 32257 109 32379 130 32523 32 32769 109 32891 130 33034 34 33281 109 33402 131 33546 35 33793 109 33913 132 34058 36 34305 108 34425 132 34569 37 34817 107 34937 132 35081 39 35329 106 35449 132 35592 41 35841 106 35961 131 36104 42 36353 106 36472 132 36615 44 36865 106 36984 132 37127 45 37377 106 37496 132 37639 46 37889 106 38008 132 38151 47 38401 106 38520 132 38663 48 38913 105 39032 132 39175 49 39425 104 39544 132 39687 50 39937 103 40055 133 40199 51 40449 103 40567 133 40711 51 40961 103 41077 135 41223 53 41473 103 41588 136 41735 54 41985 102 42099 137 42247 55 42497 101 42610 138 42759 56 43009 100 43122 138 43271 57 43521 99 43634 138 43783 58 44033 98 44146 138 44295 59 44545 97 44658 138 44807 60 45056 98 45170 138 45319 61 45567 99 45682 138 45831 62 46078 100 46194 138 46343 63 46589 100 46705 139 46855 64 47101 99 47217 139 47367 65 47612 99 47729 139 47879 66 48124 98 48241 139 48391 67 48635 98 48753 139 48903 68 49146 98 49265 138 49415 69 49657 98 49776 138 49927 70 50168 98 50288 138 50439 71 50679 98 50799 139 50950 73 51186 102 51310 140 51461 75 51697 102 51822 140 51973 76 52209 101 52333 141 52485 77 52720 102 52845 141 52997 78 53231 102 53356 142 53509 79 53742 103 53867 143 54021 79 54253 103 54378 144 54533 81 54763 105 54890 144 55045 82 55271 108 55402 145 55556 83 55782 109 55914 146 56067 85 56289 114 56425 147 56579 85 56799 116 56937 147 57091 87 57310 116 57448 148 57603 88 57821 116 57959 149 58115 88 58332 116 58470 150 58626 89 58843 116 58982 151 59137 90 59354 116 59493 246 59865 116 60005 246 60377 115 60516 249 60888 115 61027 251 61400 114 61538 253 61911 114 62049 255 62422 114 62561 255 62933 114 63073 256 63444 113 63585 256 63956 111 64096 257 64468 109 64608 257 64980 108 65119 259 65492 107 65630 261 66003 107 66141 263 66515 105 66651 267 67026 104 67162 269 67538 102 67674 269 68050 101 68186 269 68562 100 68698 269 69074 99 69209 270 69585 99 69721 271 70097 98 70232 272 70609 97 70743 273 71121 91 71255 273 71632 92 71767 273 72143 93 72278 275 72655 86 72789 277 73167 85 73300 279 73679 84 73812 279 74191 83 74324 280 74703 82 74836 280 75214 82 75347 281 75725 82 75859 281 76237 81 76368 285 76749 80 76878 288 77261 79 77390 288 77773 78 77902 288 78285 77 78414 288 78797 64 78925 289 79309 63 79437 289 79821 62 79948 290 80333 52 80459 1 80461 289 80845 52 80973 289 81357 52 81485 289 81869 52 82000 286 82381 52 82514 284 82893 52 83028 282 83405 52 83542 280 83918 51 84055 279 84431 50 84569 275 84943 50 85082 274 85455 50 85596 272 85967 50 86108 272 86479 50 86625 265 86993 48 87142 259 87505 48 87656 256 88017 48 88169 255 88529 48 88682 254 89041 48 89199 249 89553 48 89712 246 90066 47 90225 244 90578 47 90739 241 91090 47 91252 239 91602 47 91770 232 92115 46 92283 231 92628 45 92816 209 93140 45 93341 37 93408 129 93652 45 93854 35 93921 128 94164 45 94372 23 94442 118 94677 44 94884 21 94955 117 95190 43 95472 110 95702 43 95992 101 96215 42 96505 99 96728 41 97023 93 97240 41 97536 91 97752 41 98057 81 98264 41 98570 79 98776 41 99091 69 99289 40 99609 63 99801 40 100122 61 100314 39 100638 55 100826 39 101151 53 101339 38 101668 47 101853 36 102182 44 102365 36 102694 42 102878 35 103208 40 103390 35 103721 38 103902 35 104236 30 104414 35 104749 28 104926 35 105266 10 105438 35 105778 9 105950 35 106465 32 106978 31 107490 31 108004 29 108517 28 109040 17', '312 201 823 202 1334 203 1845 204 2355 206 2866 207 3377 208 3888 209 4400 209 4911 210 5422 211 5934 211 6443 214 6955 214 7467 214 7979 214 8491 214 9002 215 9512 217 10024 217 10536 217 11048 217 11559 218 12070 219 12582 219 13094 219 13606 219 14117 220 14628 221 15139 222 15650 223 16162 223 16674 223 17186 223 17698 223 18210 223 18721 224 19233 224 19745 224 20256 225 20768 225 21278 227 21789 228 22301 228 22813 228 23325 228 23835 230 24347 230 24859 230 25371 230 25883 230 26395 230 26906 231 27418 231 27929 232 28440 233 28952 233 29464 233 29976 233 30487 234 30998 235 31510 235 32022 235 32533 236 33044 237 33556 237 34068 237 34580 237 35091 238 35602 239 36114 239 36626 239 37138 239 37650 239 38162 239 38674 239 39186 239 39698 239 40209 240 40721 240 41233 240 41745 240 42256 241 42767 242 43279 242 43791 242 44303 242 44814 243 45325 244 45837 244 46349 244 46861 244 47373 244 47885 244 48396 245 48908 245 49420 245 49932 245 50444 245 50956 245 51466 247 51978 247 52490 247 53002 247 53514 247 54026 247 54537 248 55049 248 55560 249 56072 249 56584 249 57094 251 57606 251 58118 251 58630 251 59142 251 59654 251 60166 251 60678 251 61190 254 61702 255 62214 257 62726 258 63238 258 63750 261 64262 262 64774 263 65286 264 65798 266 66310 267 66822 267 67334 268 67846 268 68358 268 68870 269 69382 270 69894 271 70407 273 70920 272 71432 272 71944 273 72456 273 72968 274 73480 275 73992 275 74504 275 75016 276 75528 277 76040 277 76553 278 77066 277 77578 278 78090 278 78602 279 79115 279 79628 278 80140 279 80653 278 81165 280 81677 281 82189 281 82702 281 83215 280 83727 281 84240 280 84752 281 85265 280 85777 280 86290 281 86802 281 87314 281 87826 281 88339 282 88851 282 89364 281 89876 283 90389 282 90901 282 91414 282 91927 281 92440 280 92953 279 93466 280 93979 279 94491 280 95003 280 95515 281 96027 282 96540 282 97053 281 97566 280 98078 281 98591 281 99104 281 99617 281 100129 283 100642 283 101154 283 101666 284 102179 283 102691 283 103204 282 103717 283 104229 283 104742 282 105254 284 105767 283 106279 283 106792 282 107304 282 107817 282 108329 283 108841 283 109353 283 109866 282 110379 281 110892 280 111404 280 111917 279 112429 279 112941 279 113453 279 113965 279 114478 278 114991 277 115503 277 116015 277 116527 277 117039 278 117552 277 118064 277 118576 277 119088 277 119600 277 120114 275 120627 274 121140 273 121653 272 122166 271 122679 270 123192 269 123705 268 124218 267 124731 266 125247 262 125760 261 126273 260 126786 259 127300 258 127816 255 128329 254 128842 253 129355 252 129868 251 130381 250 130893 250 131406 249 131920 247 132433 246 132946 245 133462 241 133975 240 134488 239 135001 238 135515 236 136031 232 136544 231 137057 230 137570 229 138083 228 138596 227 139110 225 139624 223 140137 222 140650 221 141163 220 141675 220 142188 219 142701 218 143213 218 143726 217 144239 216 144752 215 145264 215 145776 215 146288 215 146800 215 147314 213 147826 213 148338 213 148850 213 149362 213 149874 213 150386 213 150898 212 151410 211 151922 211 152434 211 152946 211 153458 210 153970 208 154482 207 154994 206 155506 206 156018 206 156530 205 157042 204 157555 202 158067 201 158579 200 159091 199 159603 198 160115 197 160627 197 161139 196 161651 196 162163 195 162675 194 163187 193 163699 192 164211 191 164723 189 165235 189 165747 188 166259 187 166772 185 167285 184 167797 184 168309 183 168821 182 169333 180 169845 179 170358 177 170871 176 171383 175 171895 170 172407 169 172919 166 173432 143 173944 142 174457 136 174969 136 175482 135 175994 135 176506 135 177018 135 177531 134 178044 133 178557 132 179070 131 179583 130 180096 129 180610 127 181122 127 181635 126 182148 125 182661 152 183177 149 183690 149 184203 161 184716 161 185230 160 185746 163 186259 163 186776 159 187290 167 187808 162 188320 163 188833 169 189349 166 189862 166 190379 168 190892 168 191408 165 191921 168 192439 163 192953 162 193466 163 193983 160 194497 160 195010 160 195523 160 196040 156 196553 159 197066 159 197580 158 198093 158 198605 159 199116 1 199119 158 199640 150 200160 143 200673 143 201192 137 201705 137 202222 133 202735 133 203252 128 203768 125 204281 124 204798 120 205311 119 205825 118 206337 119 206849 120 207361 121 207873 121 208385 121 208897 121 209409 121 209921 121 210433 124 210945 124 211457 124 211969 124 212481 124 212993 124 213505 124 214017 124 214529 124 215041 124 215553 124 216065 124 216577 124 217089 125 217601 126 218113 127 218625 127 219137 127 219649 127 220161 127 220673 127 221185 127 221697 128 222209 129 222721 130 223233 130 223745 130 224257 130 224769 130 225281 130 225793 130 226305 130 226817 131 227329 131 227841 132 228353 132 228865 133 229377 133 229889 133 230401 133 230913 133 231425 133 231937 133 232449 133 232961 132 233149 8 233473 132 233660 9 233985 131 234168 18 234497 131 234679 19 235009 130 235189 23 235521 130 235700 25 236033 130 236211 27 236545 130 236722 29 237057 130 237234 30 237569 130 237746 34 238081 130 238257 36 238593 130 238767 38 239105 130 239277 41 239617 130 239789 41 240129 130 240301 42 240641 130 240812 44 241153 130 241323 46 241665 130 241835 47 242177 130 242346 50 242689 130 242858 51 243201 129 243369 52 243713 128 243880 54 244225 127 244391 56 244737 127 244902 58 245249 127 245413 60 245761 127 245925 62 246273 127 246436 64 246785 127 246948 66 247297 127 247459 68 247809 127 247970 70 248321 127 248481 73 248833 127 248992 75 249345 127 249504 75 249857 127 250015 77 250369 127 250527 78 250881 127 251038 80 251393 127 251550 81 251905 127 252061 83 252417 127 252572 85 252929 127 253083 87 253441 127 253594 89 253953 127 254106 90 254465 127 254617 92 254977 127 255128 94 255489 126 255640 94 256001 125 256151 96 256513 124 256663 96 257025 124 257175 97 257537 124 257687 97 258049 124 258199 97 258561 124 258710 98 259073 124 259222 99 259585 124 259733 101 260097 124 260244 103 260609 124 260756 104 261121 124 261267 106 261633 124 261779 106', '1 173 513 176 1025 177 1537 178 2049 178 2561 182 3073 185 3585 185 4097 186 4609 187 5121 190 5633 191 6145 194 6657 194 7169 196 7681 197 8193 198 8705 200 9217 200 9729 204 10241 204 10753 205 11265 209 11777 210 12289 211 12801 212 13313 213 13825 214 14337 215 14849 218 15361 219 15873 222 16385 222 16897 225 17409 226 17921 229 18433 230 18945 231 19457 232 19969 233 20481 236 20993 237 21505 239 22017 240 22529 243 23041 244 23553 244 24065 245 24577 245 25089 248 25601 248 26113 250 26625 252 27137 252 27649 253 28161 254 28673 255 29185 256 29697 257 30209 257 30721 258 31233 259 31745 259 32257 259 32769 260 33281 261 33793 262 34305 263 34817 264 35329 264 35841 266 36353 266 36865 268 37377 268 37889 270 38401 271 38913 272 39425 273 39937 273 40449 275 40961 276 41473 277 41985 278 42497 279 43009 280 43521 281 44033 282 44545 282 45057 283 45569 283 46081 284 46593 287 47105 287 47617 289 48129 289 48641 290 49153 292 49665 292 50177 294 50689 294 51201 294 51713 295 52225 296 52737 296 53249 297 53761 299 54273 299 54785 300 55297 300 55809 302 56321 303 56833 303 57345 304 57857 305 58369 306 58881 307 59393 308 59905 309 60417 311 60929 312 61441 312 61953 313 62465 314 62977 315 63489 316 64001 318 64513 319 65025 319 65537 320 66049 320 66561 322 67073 322 67585 323 68097 326 68609 326 69121 327 69633 328 70145 329 70657 330 71169 331 71681 333 72193 333 72705 334 73217 335 73729 336 74241 337 74753 338 75265 338 75777 339 76289 340 76801 340 77313 342 77825 342 78337 343 78849 343 79361 344 79873 345 80385 345 80897 345 81409 345 81921 347 82433 347 82945 347 83457 347 83969 347 84481 348 84993 348 85505 349 86017 349 86529 350 87041 350 87553 350 88065 350 88577 350 89089 350 89601 351 90113 352 90625 352 91137 352 91649 352 92161 353 92673 354 93185 354 93697 354 94209 354 94721 355 95233 356 95745 356 96257 356 96769 356 97281 356 97793 356 98305 356 98817 356 99329 356 99841 357 100353 357 100865 357 101377 357 101889 357 102401 357 102913 357 103425 357 103937 357 104449 357 104961 357 105473 359 105985 359 106497 359 107009 359 107521 359 108033 359 108545 359 109057 359 109569 359 110081 360 110593 361 111105 361 111617 361 112129 361 112641 362 113153 363 113665 363 114177 363 114689 363 115201 363 115713 363 116225 363 116737 363 117249 363 117761 363 118273 363 118785 364 119297 364 119809 364 120321 364 120833 364 121345 364 121857 364 122369 364 122881 364 123393 364 123905 364 124417 366 124929 366 125441 366 125953 366 126465 366 126977 366 127489 366 128001 366 128513 366 129025 366 129537 366 130049 366 130561 366 131073 366 131585 366 132097 366 132609 366 133121 366 133633 366 134145 366 134657 367 135169 368 135681 368 136193 368 136705 368 137217 368 137729 368 138241 368 138753 368 139265 366 139777 366 140289 366 140801 366 141313 366 141825 366 142337 366 142849 366 143361 366 143873 364 144385 364 144897 364 145409 364 145921 364 146433 364 146945 363 147457 363 147969 363 148481 363 148993 362 149505 361 150017 361 150529 361 151041 361 151553 361 152065 361 152577 361 153089 361 153601 361 154113 361 154625 361 155137 361 155649 361 156161 361 156673 361 157185 361 157697 360 158209 360 158721 359 159233 359 159745 359 160257 359 160769 359 161281 359 161793 359 162305 359 162817 359 163329 359 163841 359 164353 359 164865 358 165377 358 165889 357 166401 357 166913 357 167425 357 167937 357 168449 357 168961 356 169473 356 169985 356 170497 356 171009 356 171521 355 172033 354 172545 354 173057 354 173569 353 174081 352 174593 352 175105 352 175617 352 176129 351 176641 350 177153 348 177665 348 178177 347 178689 346 179201 345 179713 345 180225 345 180737 345 181249 345 181753 351 182260 356 182771 356 183279 359 183790 359 184296 364 184807 365 185313 370 185823 371 186334 371 186843 374 187355 373 187866 374 188377 374 188885 378 189396 379 189908 379 190419 380 190931 379 191442 379 191954 378 192464 378 192975 378 193486 378 193997 379 194509 378 195020 379 195531 380 196042 381 196553 382 197063 382 197574 382 198085 382 198596 382 199108 381 199619 382 200130 382 200640 384 201151 385 201662 386 202173 386 202685 385 203196 385 203707 385 204217 386 204728 387 205240 386 205751 387 206263 386 206774 386 207286 385 207794 388 208305 389 208816 389 209327 390 209839 390 210350 390 210861 390 211372 390 211883 390 212393 391 212904 390 213415 389 213926 389 214438 388 214948 389 215459 389 215970 389 216481 388 216993 386 217502 389 218013 389 218522 391 219033 391 219544 390 220054 388 220564 389 221075 389 221586 389 222097 389 222609 388 223119 388 223626 393 224138 392 224647 394 225158 394 225669 394 226179 395 226689 396 227200 396 227711 396 228220 398 228731 398 229241 399 229752 399 230260 401 230771 402 231283 401 231794 401 232305 401 232816 401 233327 401 233838 401 234349 400 234860 149 235010 249 235371 150 235525 245 235882 151 236039 242 236391 154 236551 241 236902 155 237064 239 237413 156 237583 231 237925 156 238097 228 238436 157 238611 225 238946 159 239124 222 239457 160 239637 219 239968 161 240150 218 240480 161 240664 215 240991 162 241178 212 241503 162 241692 209 242013 164 242206 205 242524 165 242718 204 243036 165 243231 202 243547 166 243748 196 244058 167 244261 194 244569 168 244774 193 245080 169 245288 190 245591 170 245802 186 246102 171 246315 184 246613 172 246828 182 247124 173 247344 177 247635 174 247857 175 248146 175 248370 174 248657 176 248883 172 249168 177 249400 165 249679 178 249913 164 250191 178 250426 163 250702 179 250943 157 251214 179 251457 154 251725 180 251970 152 252236 181 252484 148 252746 183 252998 144 253257 184 253515 138 253768 185 254028 136 254279 186 254540 132 254791 186 255053 130 255302 187 255574 120 255813 188 256088 117 256324 189 256604 112 256835 190 257117 110 257344 193 257673 61 257856 193 258197 48 258367 194 258710 46 258879 194 259233 35 259390 195 259746 33 259901 196 260270 15 260412 197 260784 11 260922 199 261433 200 261945 200', '1 445 513 445 1025 445 1537 445 2049 445 2561 445 3073 445 3585 444 4097 444 4609 444 5121 444 5633 444 6145 444 6657 444 7169 444 7681 444 8193 443 8705 442 9217 442 9729 442 10241 442 10753 442 11265 442 11777 442 12289 442 12801 442 13313 442 13825 442 14337 442 14849 442 15361 442 15873 442 16385 443 16897 444 17409 444 17921 444 18433 444 18945 444 19457 444 19969 444 20481 444 20993 444 21505 444 22017 444 22529 444 23041 444 23553 444 24065 444 24577 444 25089 444 25601 444 26113 444 26625 444 27137 443 27649 442 28161 442 28673 442 29185 442 29697 441 30209 440 30721 440 31233 439 31745 439 32257 438 32769 437 33281 436 33793 434 34305 433 34817 432 35329 432 35841 431 36353 430 36865 429 37377 428 37889 427 38401 426 38913 425 39425 424 39937 423 40449 422 40961 421 41473 420 41985 418 42497 416 43009 415 43521 414 44033 413 44545 412 45057 408 45569 407 46081 405 46593 404 47105 403 47617 402 48130 400 48643 398 49156 396 49673 390 50186 388 50699 387 51212 385 51724 385 52237 383 52751 381 53265 378 53779 374 54292 372 54805 370 55318 368 55832 365 56345 363 56858 361 57371 359 57884 357 58402 351 58914 350 59426 350 59942 345 60455 343 60968 341 61481 339 61995 336 62509 333 63022 332 63535 330 64047 330 64560 328 65072 327 65584 326 66098 323 66611 321 67124 319 67638 316 68152 313 68665 311 69178 309 69691 307 70205 304 70719 300 71232 298 71745 295 72258 293 72771 291 73287 286 73800 284 74313 282 74826 280 75343 274 75856 272 76372 267 76884 265 77400 260 77913 258 78431 250 78948 243 79462 239 79975 237 80488 235 81004 230 81517 228 82030 227 82543 225 83061 213 83578 207 84092 204 84605 202 85118 200 85635 195 86148 193 86660 192 87173 190 87690 184 88203 182 88719 177 89232 175 89750 168 90264 165 90778 161 91291 159 91804 157 92316 157 92829 155 93345 150 93857 149 94374 139 94888 136 95403 131 95916 128 96428 127 96941 125 97454 123 97971 116 98484 113 99001 104 99515 101 100029 98 100543 95 101055 94 101568 92 102085 86 102598 84 103116 76 103628 75 104141 72 104658 66 105171 64 105699 43 106212 41 106739 22 107252 20 245806 36 246317 37 246823 51 247329 65 247840 68 248350 75 248861 76 249367 87 249878 89 250385 98 250892 109 251403 110 251911 117 252422 119 252929 127 253441 129 253953 132 254465 139 254977 140 255489 144 256001 145 256513 155 257025 155 257537 159 258049 162 258561 163 259073 165 259585 166 260097 167 260609 168 261121 169 261633 171', '138 236 648 239 1157 243 1669 244 2180 246 2691 248 3202 250 3714 251 4226 252 4738 252 5250 252 5762 252 6273 253 6785 253 7296 254 7808 254 8320 255 8832 256 9344 256 9857 255 10369 255 10882 254 11394 254 11906 254 12418 254 12930 254 13444 252 13956 252 14468 252 14980 252 15492 252 16004 252 16516 252 17028 252 17540 252 18052 252 18564 252 19076 251 19588 250 20100 249 20613 247 21125 246 21637 245 22149 245 22662 243 23175 241 23688 240 24201 238 24714 237 25227 235 25739 234 26251 234 26763 233 27276 232 27789 230 28302 229 28815 227 29327 227 29840 225 30353 224 30866 222 31379 221 31892 219 32409 213 32922 211 33436 209 33948 209 34461 208 34974 206 35487 204 36000 202 36513 200 37026 199 37539 198 38056 193 38569 192 39082 190 39595 188 40108 186 40621 184 41134 182 41647 180 42160 178 42673 176 43186 174 43699 172 44212 170 44725 169 45239 166 45753 162 46266 160 46779 158 47292 156 47805 154 48322 147 48836 143 49349 141 49862 139 50376 132 50889 129 51402 126 51918 121 52431 118 52944 116 53457 114 53974 108 54487 106 55003 100 55516 97 56033 91 56546 89 57066 77 57579 75 58096 68 58609 62 59122 60 59639 51 60152 49 60669 42 61183 38 61696 33 62209 31 62727 19 63247 10 63760 8 82768 5 83280 6 83785 18 84296 20 84804 25 85315 26 85822 34 86333 36 86840 43 87350 48 87860 51 88370 54 88880 56 89391 60 89902 62 90410 67 90921 69 91429 74 91939 77 92448 81 92960 81 93467 87 93978 88 94488 92 94993 101 95503 104 96014 106 96525 108 97032 114 97544 115 98047 125 98559 126 99065 134 99576 136 100087 137 100592 144 101102 147 101613 148 102124 150 102633 154 103144 156 103655 158 104166 160 104676 163 105187 165 105698 167 106209 169 106717 174 107228 176 107739 177 108250 179 108760 181 109271 183 109782 185 110291 189 110802 191 111312 195 111823 197 112335 198 112846 200 113358 200 113869 201 114381 203 114892 205 115403 206 115914 208 116425 209 116936 211 117447 213 117958 215 118469 217 118980 220 119492 221 120004 222 120516 223 121027 226 121538 228 122049 230 122560 232 123072 233 123583 236 124095 237 124606 238 125117 239 125628 241 126139 243 126650 245 127159 249 127670 252 128181 254 128693 255 129204 257 129715 259 130226 261 130737 262 131247 266 131756 271 132267 273 132778 275 133289 276 133799 279 134310 281 134821 283 135332 285 135840 290 136351 292 136862 295 137372 298 137883 300 138394 302 138905 303 139413 307 139923 309 140434 311 140945 312 141453 316 141964 317 142471 322 142981 325 143491 328 144000 332 144511 333 145022 335 145533 336 146040 341 146552 341 147061 344 147572 345 148082 347 148592 350 149102 352 149613 354 150125 354 150637 354 151148 355 151660 355 152171 357 152682 359 153193 360 153704 361 154215 362 154724 365 155235 366 155745 368 156254 371 156764 373 157275 374 157786 375 158297 376 158808 376 159319 376 159830 376 160341 377 160848 381 161359 382 161870 383 162381 384 162892 385 163403 385 163914 385 164425 386 164936 387 165448 387 165959 388 166470 389 166981 389 167492 390 168002 391 168513 392 169024 393 169535 394 170046 395 170557 395 171069 395 171580 396 172091 397 172601 399 173112 398 173624 398 174136 398 174648 398 175160 398 175671 399 176182 400 176694 400 177206 400 177718 399 178230 398 178741 399 179252 400 179763 401 180275 401 180786 400 181297 401 181808 402 182320 402 182832 402 183344 402 183856 402 184368 402 184879 403 185391 404 185903 404 186415 405 186927 405 187438 406 187950 406 188461 407 188973 407 189484 408 189996 408 190507 409 191019 409 191531 409 192043 409 192555 410 193066 412 193578 412 194089 413 194601 413 195112 414 195624 414 196135 415 196646 416 197158 417 197669 419 198181 419 198692 420 199204 420 199715 421 200227 421 200738 423 201249 424 201760 425 202271 426 202782 427 203294 428 203806 429 204318 429 204830 429 205341 430 205853 431 206364 433 206875 434 207386 435 207897 436 208408 437 208920 438 209430 441 209941 442 210452 443 210962 445 211472 447 211983 448 212494 449 213005 450 213517 450 214028 451 214539 452 215050 453 215561 454 216072 455 216583 456 217093 458 217603 460 218113 462 218625 462 219137 462 219649 462 220161 462 220673 462 221185 462 221697 462 222209 462 222721 462 223233 462 223745 462 224257 462 224769 462 225281 462 225793 462 226305 462 226817 462 227329 462 227841 462 228353 462 228865 462 229377 462 229889 462 230401 462 230913 462 231425 462 231937 462 232449 461 232961 460 233473 460 233985 460 234497 460 235009 460 235521 460 236033 460 236545 460 237057 459 237569 458 238081 458 238593 458 239105 458 239617 458 240129 457 240641 456 241153 456 241665 456 242177 456 242689 456 243201 455 243713 454 244225 453 244737 453 245249 453 245761 453 246273 453 246785 451 247297 451 247809 450 248321 450 248833 449 249345 449 249857 449 250369 449 250881 449 251393 448 251905 447 252417 447 252929 447 253441 447 253953 447 254465 447 254977 447 255489 447 256001 447 256513 447 257025 447 257537 447 258049 447 258561 447 259073 447 259585 446 260097 445 260609 445 261121 445 261633 445', '130335 11 130846 14 131357 23 131868 25 132373 36 132883 39 133393 42 133903 45 134413 55 134920 70 135432 71 135941 75 136452 76 136963 82 137474 84 137983 88 138493 91 139004 95 139515 97 139979 146 140469 171 140981 172 141480 186 141672 2 141992 187 142184 5 142495 199 142697 6 143006 201 143209 7 143514 206 143721 10 144025 207 144234 10 144532 226 145043 228 145552 232 146064 233 146574 239 147085 241 147596 243 148107 245 148618 246 149129 248 149640 250 150151 252 150662 254 151173 256 151685 257 152195 261 152704 265 153215 267 153726 272 154237 274 154746 278 155258 279 155770 280 156282 281 156794 282 157305 284 157816 289 158328 290 158839 297 159350 299 159862 300 160373 302 160885 304 161396 306 161908 307 162419 309 162931 310 163443 311 163955 312 164467 317 164981 316 165493 317 166005 318 166517 319 167029 320 167541 321 168053 322 168566 322 169079 323 169591 325 170104 325 170616 325 171128 327 171640 328 172152 329 172663 331 173175 332 173687 333 174199 334 174711 335 175223 336 175733 339 176245 339 176756 342 177267 344 177778 346 178289 348 178801 349 179313 350 179825 351 180337 352 180848 354 181359 356 181871 357 182382 359 182894 359 183405 360 183916 361 184428 361 184940 362 185452 362 185964 362 186476 362 186989 361 187502 361 188015 361 188528 360 189041 359 189555 357 190068 357 190581 357 191093 357 191605 357 192117 357 192629 357 193141 357 193653 357 194165 357 194677 357 195189 357 195701 358 196213 358 196725 359 197237 359 197749 359 198261 359 198772 360 199283 361 199795 361 200307 361 200819 361 201331 361 201845 359 202357 359 202869 359 203381 359 203893 359 204405 359 204917 359 205429 359 205941 359 206454 358 206967 357 207479 357 207991 357 208503 357 209016 356 209530 354 210043 353 210556 352 211069 351 211582 350 212095 349 212608 348 213121 347 213634 346 214148 344 214662 342 215175 341 215688 340 216201 339 216714 338 217227 337 217740 336 218253 335 218766 334 219280 331 219793 330 220306 328 220819 327 221332 326 221846 324 222359 56 222435 246 222872 54 222949 243 223386 48 223470 233 223900 45 223983 231 224412 40 224503 223 224925 38 225016 222 225439 32 225532 218 225953 29 226045 217 226467 20 226563 210 227079 205 227592 203 228109 197 228622 195 229139 189 229652 187 230169 182 230683 180 231196 179 231709 178 232222 176 232736 173 233249 171 233762 170 234276 167 234789 166 235302 165 235815 163 236328 160 236841 159 237354 157 237870 153 238296 32 238383 151 238801 47 238897 147 239312 49 239410 145 239820 60 239923 143 240331 61 240436 141 240840 75 240949 139 241351 77 241464 132 241862 86 241976 131 242373 88 242493 125 242882 95 243006 123 243393 97 243520 119 243904 127 244034 115 244416 128 244547 110 244925 243 245436 139 245576 103 245946 244 246455 244 246966 154 247123 86 247477 156 247636 84 247989 157 248153 75 248496 165 248666 73 249007 167 249182 68 249514 177 249695 66 250025 179 250230 38 250534 184 250743 36 251045 187 251264 25 251556 189 251781 14 252063 199 252294 12 252574 201 253085 203 253597 203 254108 205 254619 207 255130 209 255641 211 256152 213 256663 215 257174 219 257685 221 258195 224 258704 227 259216 227 259727 228 260238 230 260749 233 261260 234 261771 235', '1 223 513 223 1025 223 1537 223 2049 223 2561 223 3073 223 3585 222 4097 222 4609 221 5121 221 5633 221 6145 221 6657 221 7169 221 7681 221 8193 221 8705 221 9217 221 9729 221 10241 221 10753 219 11265 219 11777 219 12289 219 12801 219 13313 219 13825 219 14337 219 14849 218 15361 218 15873 218 16385 218 16897 218 17409 218 17921 218 18433 218 18945 218 19457 216 19969 216 20481 216 20993 216 21505 215 22017 215 22529 214 23041 214 23553 214 24065 214 24577 214 25089 214 25601 214 26113 214 26625 213 27137 212 27649 212 28161 212 28673 212 29185 212 29697 212 30209 212 30721 211 31233 211 31745 210 32257 210 32769 210 33281 210 33793 210 34305 210 34817 209 35329 209 35694 8 35841 209 36205 9 36353 209 36699 41 36865 209 37205 61 37377 209 37716 62 37889 208 38222 74 38401 208 38733 77 38913 207 39240 86 39425 207 39750 89 39937 207 40257 97 40449 207 40757 114 40961 207 41268 116 41473 207 41776 122 41985 207 42287 124 42497 207 42795 131 43009 206 43306 133 43521 205 43813 141 44033 205 44324 147 44545 205 44835 149 45057 205 45346 154 45569 204 45857 156 46081 204 46368 165 46593 204 46879 167 47105 204 47390 174 47617 203 47901 175 48129 202 48412 182 48641 200 48924 187 49153 200 49436 189 49665 200 49947 194 50177 200 50458 196 50689 200 50968 205 51201 199 51479 208 51713 199 51990 211 52225 198 52501 216 52737 197 53013 217 53249 196 53524 219 53761 196 54035 221 54273 196 54546 223 54785 195 55058 224 55297 195 55570 226 55809 193 56082 228 56321 193 56593 230 56833 193 57104 232 57345 193 57616 232 57857 193 58127 235 58369 191 58639 235 58881 191 59150 238 59393 191 59662 239 59905 190 60173 241 60417 189 60685 242 60929 189 61197 243 61441 189 61708 433 62220 433 62731 432 63242 433 63754 433 64263 436 64775 436 65287 433 65799 432 66310 433 66821 433 67333 432 67844 433 68355 433 68866 433 69377 433 69888 434 70399 435 70911 435 71422 434 71934 434 72445 434 72956 435 73466 435 73977 435 74487 436 74998 437 75510 437 76021 438 76533 438 77044 438 77555 438 78064 439 78575 440 79086 441 79597 442 80108 443 80619 444 81130 444 81641 443 82152 443 82663 443 83174 444 83685 444 84196 445 84707 445 85218 446 85730 446 86241 446 86753 446 87264 447 87775 447 88286 447 88798 443 89309 444 89820 445 90331 445 90843 445 91355 444 91866 444 92378 444 92889 445 93400 446 93912 443 94424 442 94936 442 95448 441 95959 442 96471 442 96981 444 97492 443 98004 443 98516 443 99028 443 99540 440 100051 440 100562 440 101074 440 101586 439 102098 438 102610 438 103121 439 103632 440 104143 437 104655 437 105167 436 105679 436 106191 436 106702 434 107214 433 107725 433 108237 432 108748 431 109260 431 109771 431 110282 431 110794 430 111306 426 111818 426 112329 426 112840 426 113352 425 113863 423 114375 422 114886 421 115397 421 115907 419 116419 318 116738 100 116931 318 117251 98 117443 318 117766 88 117954 319 118278 87 118465 320 118793 82 118976 321 119306 80 119487 322 119821 75 119998 323 120337 67 120510 323 120850 65 121021 324 121370 56 121533 324 121882 55 122042 327 122402 43 122554 327 122916 40 123066 327 123437 17 123578 327 124089 328 124600 329 125112 329 125624 329 126136 329 126648 329 127160 329 127672 329 128184 329 128695 330 129206 331 129718 331 130230 331 130742 331 131254 331 131766 331 132278 331 132790 331 133301 332 133812 333 134324 333 134836 333 135348 333 135860 333 136369 1 136372 333 136880 2 136884 333 137391 3 137396 333 137903 4 137908 333 138413 340 138924 341 139436 341 139948 341 140460 341 140972 341 141485 340 141998 339 142510 339 143022 339 143534 339 144046 339 144559 338 145072 337 145585 336 146098 335 146611 334 147124 333 147637 332 148150 331 148662 331 149174 331 149688 329 150201 328 150714 327 151227 326 151740 325 152252 325 152765 324 153278 323 153791 322 154308 317 154825 312 155338 311 155854 307 156367 306 156883 302 157396 301 157910 299 158426 295 158939 294 159452 293 159965 292 160482 287 160996 285 161510 283 162026 279 162539 278 163052 277 163565 276 164078 188 164287 66 164592 185 164800 65 165106 177 165318 59 165623 172 165836 53 166136 170 166350 51 166648 169 166863 50 167161 167 167376 49 167674 164 167893 44 168187 161 168407 42 168700 160 168923 38 169135 16 169213 158 169436 37 169646 18 169726 153 169954 31 170157 20 170239 151 170467 30 170659 31 170752 149 170980 29 171170 33 171265 145 171499 22 171681 35 171778 144 172012 21 172189 40 172291 142 172525 20 172700 42 172804 140 173038 19 173211 44 173318 136 173556 13 173722 52 173830 134 174073 8 174233 54 174343 132 174586 7 174744 56 174856 130 175255 58 175369 128 175766 60 175882 126 176277 62 176395 124 176788 64 176909 120 177299 66 177421 118 177811 67 177934 116 178318 73 178447 114 178829 74 178960 112 179341 74 179473 110 179852 78 179986 108 180364 79 180500 106 180876 80 181012 106 181388 81 181524 106 181713 10 181898 84 182037 105 182224 12 182409 86 182549 104 182735 14 182918 93 183062 102 183240 57 183428 95 183575 100 183751 58 183939 96 184088 99 184262 59 184450 97 184601 98 184768 65 184961 99 185115 96 185280 65 185473 100 185627 95 185792 65 185983 106 186139 94 186298 71 186493 109 186652 92 186808 73 187003 112 187164 91 187319 74 187514 114 187677 90 187828 77 188024 117 188189 90 188338 79 188535 119 188702 89 188849 80 189046 121 189215 88 189354 87 189557 123 189728 86 189865 88 190069 124 190240 85 190377 88 190571 135 190753 83 190885 92 191083 136 191265 83 191396 93 191595 137 191778 82 191907 94 192092 156 192291 81 192418 95 192604 157 192803 80 192929 96 193115 159 193316 78 193440 97 193627 160 193828 78 193951 98 194138 161 194341 77 194462 99 194650 161 194854 76 194973 100 195161 162 195366 76 195484 101 195673 163 195879 75 195996 101 196185 164 196392 73 196508 101 196697 166 196905 71 197017 104 197209 168 197417 71 197529 104 197721 170 197929 71 198040 105 198233 174 198441 71 198552 105 198745 175 198953 71 199063 106 199257 176 199467 69 199575 106 199769 177 199979 69 200086 107 200281 178 200491 69 200597 108 200793 179 201004 68 201108 109 201305 180 201516 68 201619 110 201818 180 202029 67 202130 111 202331 180 202541 67 202641 112 202844 180 203054 66 203152 113 203357 180 203567 65 203663 114 203870 180 204080 64 204174 115 204383 183 204592 64 204685 116 204896 182 205105 63 205196 117 205409 181 205617 63 205707 118 205922 180 206130 61 206218 119 206435 180 206642 61 206730 119 206948 180 207155 60 207241 120 207461 180 207670 57 207753 120 207974 180 208184 55 208264 121 208487 180 208697 54 208776 121 209000 180 209209 53 209287 122 209513 180 209722 51 209798 123 210026 180 210236 47 210309 124 210539 180 210749 46 210817 128 211051 181 211262 45 211329 128 211563 182 211775 43 211841 128 212075 186 212288 41 212353 128 212588 186 212804 37 212864 129 213101 186 213317 36 213375 130 213614 186 213830 34 213886 131 214127 186 214343 32 214397 132 214640 186 214856 30 214908 133 215153 186 215373 24 215419 134 215666 186 215886 22 215930 135 216179 186 216403 13 216441 136 216692 186 216917 11 216952 137 217205 186 217430 6 217463 138 217717 187 217943 4 217974 139 218230 190 218479 146 218743 190 218990 147 219257 189 219501 148 219770 192 220003 158 220283 192 220514 159 220795 193 221025 160 221308 199 221524 173 221820 200 222036 173 222332 201 222548 173 222844 389 223357 388 223871 386 224384 385 224897 384 225409 384 225922 383 226434 383 226946 383 227458 383 227970 383 228482 383 228994 383 229507 382 230019 382 230532 381 231045 380 231557 380 232070 379 232583 378 233095 378 233608 377 234121 376 234635 374 235148 373 235661 372 236173 372 236686 371 237199 370 237713 368 238226 367 238739 366 239251 366 239764 365 240277 364 240790 363 241303 362 241815 362 242327 362 242839 362 243352 361 243865 360 244378 359 244892 357 245406 355 245920 353 246433 352 246946 351 247459 350 247972 349 248485 348 248998 347 249512 345 250026 343 250540 341 251053 340 251566 339 252079 338 252592 337 253105 336 253618 335 254131 334 254644 333 255157 332 255670 331 256183 330 256696 329 257210 327 257724 325 258238 323 258751 322 259264 321 259777 320 260290 319 260803 318 261316 317 261829 316']
biopsy (object, 12581 distinct): ['10044_000.png', '10044_001.png', '10044_002.png', '10044_003.png', '10044_004.png', '10044_005.png', '10044_006.png', '10044_007.png', '10044_008.png', '10044_009.png']
'''

BIOPSY = "biopsy"


def load_df(dir_path: str) -> DataFrame:
    df = load_csv(dir_path, "train_tiles.csv")
    df[BIOPSY] = df.apply(lambda x: _collect_img(x, dir_path=dir_path), axis=1)
    return df


def _collect_img(row: Series, dir_path: str) -> DataFrame:
    idx = str(row['idx']).zfill(3)
    img_name = f"{row['id']}_{idx}.png"
    if not exists(join(dir_path, IMAGE_FOLDER, img_name)):
        raise FileNotFoundError(f"Image not found: {img_name}")
    return img_name


CONTEXT = ""
TARGET = CuratedTarget(raw_name='age', task_type=SupervisedTask.REGRESSION)
COLS_TO_DROP = [
    # Picture IDs
    'id', 'idx',
    # Constants
    'pixel_size', 'tissue_thickness', 'data_source',
    # Should be irrelevant
    "img_height", "img_width"
    
]
FEATURES = [CuratedFeature(raw_name=BIOPSY, feat_type=FeatureType.IMAGE),
            CuratedFeature(raw_name='rle', feat_type=FeatureType.TEXT)]
IMAGE_FOLDER = "train_tiles_images"
LOADING_FUNC = load_df
