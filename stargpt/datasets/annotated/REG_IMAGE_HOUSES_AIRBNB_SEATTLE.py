from os.path import join
from typing import List

from pandas import DataFrame, read_csv, Series

from tabstar2.utils.images import download_url_image_column
from tabstar_paper.datasets.curation_objects import CuratedTarget, CuratedFeature
from tabstar_paper.datasets.objects import SupervisedTask, FeatureType

'''
Dataset Name: airbnb/seattle/
====
Examples: 3818
====
URL: https://www.kaggle.com/airbnb/seattle
====
Description: 

Airbnb Rates Dataset
This dataset includes Airbnb listings from Seattle with structured features such as property type, room type, coordinates,
and host metrics, alongside rich textual fields like listing summaries, neighborhood overviews, and amenities. The
prediction target is the listing price (continuous regression). It is a mix of structured and textual inputs making it an
excellent benchmark for assessing how well tabular models can leverage textual embeddings in price prediction tasks.

About Dataset
Context
Since 2008, guests and hosts have used Airbnb to travel in a more unique, personalized way. As part of the Airbnb Inside initiative, this dataset describes the listing activity of homestays in Seattle, WA.

Content
The following Airbnb activity is included in this Seattle dataset:

Listings, including full descriptions and average review score
Reviews, including unique id for each reviewer and detailed comments
Calendar, including listing id and the price and availability for that day
Inspiration
Can you describe the vibe of each Seattle neighborhood using listing descriptions?
What are the busiest times of the year to visit Seattle? By how much do prices spike?
Is there a general upward trend of both new Airbnb listings and total Airbnb visitors to Seattle?
For more ideas, visualizations of all Seattle datasets can be found here.

Acknowledgement
This dataset is part of Airbnb Inside, and the original source can be found here.

====
Target Variable: price (float64, 273 distinct): ['150.0', '100.0', '75.0', '95.0', '99.0', '90.0', '125.0', '65.0', '85.0', '80.0']
====
Features:

name (object, 3792 distinct): ['Capitol Hill Apartment', 'Private bath walk UW U Village(202)', 'Seattle Downtown Convention Center', 'Private room in West Seattle', 'Cozy studio in Capitol Hill!', 'Secluded Setting in North Seattle', 'Luxury Apt/Downtown West Seattle', 'Capitol Hill Studio Apartment', '"THE 5-STAR HOUSE" ', '2 Baths W/D,View walk UW (302)']
summary (object, 3478 distinct): ['This is a modern fully-furnished studio apartment in a brand new building on Capitol Hill. At Roy Street Commons you can enjoy your complete privacy and mingle with our other guests in our common areas, when it suits you.', 'Our space is a mix of a hostel and a home. We are a group of long-term residents & subletors who welcome short term guests. This is the house to meet folks whether you are moving to town or traveling through. The house offers quiet and social spaces.', "Built, run and supported by Seattle tech and start up veterans, GrokHome's focus is to create a supportive environment for smart people working on interesting projects, start ups and more. This listing is an upper bunk, in a 4-person shared room.", "Built, run and supported by Seattle tech and start up veterans, GrokHome's focus is to create a supportive environment for smart people working on interesting projects, start ups and more. This listing is a lower bunk, in a 4-person shared room.", "One block from Pike Place Market, the best of Seattle's downtown is at your fingertips in the beautiful Harbor Steps apartments. This unit features 2 Bedroom, 2 Bathroom, is Family Friendly and Handicap Accessible, and Sleeps 6. Free parking, 1 car.", 'Seattle Suites, LLC manages privately owned furnished condos in the heart of downtown Seattle.  Our comfortable beds, great location, flexible pricing and lengths of stay make us the perfect choice for business and leisure travel.  ', "Built, run and supported by Seattle tech and start up veterans, GrokHome's focus is to create a supportive environment for smart people working on interesting projects, start ups and more. This listing is an upper bunk, in a 2-person shared room.", 'The Metropolitan Tower property is centrally located on Westlake Avenue, between 6th and 7th. This unit features 2 Bedrooms, 2 Bathrooms, Kitchen, Washer/Dryer, and Sleeps 6.   ', 'This room is spacious, clean and comfortable only two blocks away from the University & 10 minutes on the bus to Downtown. Some of the best coffee shops, movie theaters, bookshops and ethnic restaurants are in the University District.', "It has a Walk Score of 98 out of 100--Walker's Paradise. the Ave, UW Tower, Hotel Deca just across the street. Very clean . 5-8 min drive to Children Hospital, downtown Seattle,Portage Bay, Lake Union and Eastlake. Easy bus to Amazon or Microsoft."]
space (object, 3119 distinct): ["*Note: This fall, there will be major renovations happening on one kitchen and bathroom at a time. There will always be two other working kitchens and two working bathrooms in the house. We'll work to minimize the impact these renovations have on your stay. **This listing is only available to those working in the tech/science space. Live in a hacker house, and immerse yourself in the Seattle tech scene. You can expect to be surrounded by smart people solving big problems or working on something fun. We have frequent demo nights, and love when our guests share something they are passionate about. If you're new to the city, our deep ties to the Seattle tech scene can help you get involved. Expand your network, develop your ideas, and learn something new by living in a hacker house. Just inquire to apply.", 'This is a fully-furnished studio designed for one person, but the vast majority of couples who have stayed with us find the intimate space cozy. The unit is compact and the bathroom is separated from the rest of the studio by a curtain. Your completely private studio space includes the following: Closet Shelves Desk Lamp Full Sized Bed Refrigerator Microwave Sink Toilet Shower Central Air', "AMAZING BUILDING, AMENITIES, AND LOCATION WITH A VIEW!!! The Property Who says you can't have it all? This amazing property is located in one of Seattle's best neighborhoods and is only a few blocks from the legendary Pike's Place market and walking distance to many of Seattle's hot spots. Walk over to Safeco Field and Seahawks Stadium, visit the hottest restaurants and bars or take the monorail to Seattle Center and Key arena. Don't worry, you won't navigate living in this gem of a property alone, you will have access to one of our amazing concierges. Perfect Location Our business travelers will enjoy Metro's prime location. The property is situated near UPS and FedEx with many car rental companies located a few minutes away from our vacation rental. Of course, those of us that lead a busy lifestyle still need to eat, but fortunately, the Shelby is close to many of Seattle's finest restaurants. Many of the restaurants have Zagat customer ratings of extraordinary to perfection, so you ", 'Our listing offers a unique Airbnb experience of staying with other Airbnb guests in a shared room as well as in a house of roommates who live in Seattle. This room is a great fit for individual or groups of travelers on a budget who are interested in meeting interesting people right in the place they are staying! We created this house so that people from around the world could meet, share experiences together and potentially create long lasting friendships that go beyond their time in our house. In a big house we are making the world smaller with more connections between people. Below is more information about your shared room, about us and about our house. Read through and see if we are a good fit for your trip! ABOUT YOUR SHARED ROOM:  This is a shared room with up to 7 other people who are all staying short term (1 night - 1 month). When you book this listing you are reserving one out of 8 beds. This listing is not specific to a top or bottom bunk. When you arrive you can choose wh', '*This listing is only available to those working in the tech/science space.* Live in a hacker house, and immerse yourself in the Seattle tech scene.  Connecting people through new ideas and technology is a huge part of what we do. You can expect demos and talks from people doing incredible work. We love when our guests want to show off something they are working on or are passionate about.  Our residents attend myriad events in technology around the city, and it is likely you will expand your network during your stay. From researchers at the University of Washington, to indie game developers, to interns at (SENSITIVE CONTENTS HIDDEN), we are proud to host a diverse group of hackers, makers and entrepreneurs. Just inquire to apply.', 'UNIT HAS BEEN RENOVATED! FIXTURES ARE UPGRADED. NEW PICTURES COMING SOON! 2 BLOCKS TO PIKE PLACE MARKET AND 1/2 BLOCK TO WATER AND PIERS!!! Live like a local during your stay at the amazing Harbor Steps property located in the heart of downtown Seattle! You\'ll be a couple blocks away from the famous Pike Place Market and right in the middle of all the action. Experience everything that Seattle has to offer: fantastic dining, vibrant nightlife, and exciting family activities! The Harbor Steps property is located on First avenue, between Seneca and University in the Belltown neighborhood, two blocks from Seattle Waterfront. The property is an easy trip from SEA-TAC airport by car and rail. Harbor Steps: -2 bedrooms with a king bed and a queen bed, and either a pull-out sofa or 2 rollaways  -2 full bathrooms  -Sleeps 6  -1100 square feet  -Free Parking Space for 1 vehicle: 6\'5" clearing! Nearby Attractions: -Pike Place Market: 2 blocks  -Seattle Art Museum: 2 blocks  -Space Needle: 1.3 mi', 'Our listing offers a unique Airbnb experience of staying with other Airbnb guests in a shared room as well as in a house of roommates who live in Seattle. This room is a great fit for individual or groups of travelers on a budget who are interested in meeting interesting people right in the place they are staying! We created this house so that people from around the world could meet, share experiences together and potentially create long lasting friendships that go beyond their time in our house. In a big house we are making the world smaller with more connections between people. Below is more information about your shared room, about us and about our house. Read through and see if we are a good fit for your trip! ABOUT YOUR SHARED ROOM:  This is a shared room with up to 4 other people who are all staying short term (1 night - 1 month). When you book this listing you are reserving one out of 5 beds (2 bunk beds and one lofted bed). This listing is not specific to a top or bottom bunk. ', 'Close to Green lake park, downtown seattle, university of washington', "UNIT HAS BEEN RENOVATED! UPDATED PICS COMING SOON! 2 BLOCKS TO PIKE PLACE MARKET AND 1/2 BLOCK TO WATER AND PIERS!!! Live like a local during your stay at the amazing Harbor Steps property located in the heart of downtown Seattle! You'll be a couple blocks away from the famous Pike Place Market and right in the middle of all the action. Experience everything that Seattle has to offer: fantastic dining, vibrant nightlife, and exciting family activities! The Harbor Steps property is located on First avenue, between Seneca and University in the Belltown neighborhood, two blocks from Seattle Waterfront. The property is an easy trip from SEA-TAC airport by car and rail. Harbor Steps: -2 bedrooms with a king bed and a queen bed, and either a pull-out sofa or 2 rollaways  -2 full bathrooms  -Sleeps 6  -1100 square feet  Nearby Attractions: -Pike Place Market: 2 blocks  -Seattle Art Museum: 2 blocks  -Space Needle: 1.3 miles  -Pacific Science Center: 1.3 miles  -Experience Music Project: 1.3 m", "Via6 in Seattle is a brand new property for us, so we will have new photos as soon as possible. Visit our other listings to see how we typically decorate our units and to read our great reviews. Experience downtown Seattle's hottest new vertical community: the amazing Via6. Enjoy everything that Seattle has to offer: fantastic dining, vibrant nightlife, and exciting family activities. The Via6 is a fantastic home base for your perfect Seattle vacation! The Via6 property is centrally located on 6th Avenue between Blanchard and Lenora Streets. Everything you need is within walking distance and Seattle's excellent public transit system makes it easy to explore the city's wonderful neighborhoods. Via6: •2 Bedrooms with a king bed, a queen bed, and a queen-size pull out sofa  •2 Full bathrooms  •Sleeps 6  •1000 square feet  Nearby Attractions:  •Pike Place Market: 0.5 mile  •Seattle Art Museum: 0.5 mile  •Pacific Science Center: 0.6 mile  •Space Needle: 0.7 mile  •Experience Music Project: "]
description (object, 3742 distinct): ['Our space is a mix of a hostel and a home. We are a group of long-term residents & subletors who welcome short term guests. This is the house to meet folks whether you are moving to town or traveling through. The house offers quiet and social spaces. Our listing offers a unique Airbnb experience of staying with other Airbnb guests in a shared room as well as in a house of roommates who live in Seattle. This room is a great fit for individual or groups of travelers on a budget who are interested in meeting interesting people right in the place they are staying! We created this house so that people from around the world could meet, share experiences together and potentially create long lasting friendships that go beyond their time in our house. In a big house we are making the world smaller with more connections between people. Below is more information about your shared room, about us and about our house. Read through and see if we are a good fit for your trip! ABOUT YOUR SHARED ROOM:  ', "This is a modern fully-furnished studio apartment in a brand new building on Capitol Hill. At Roy Street Commons you can enjoy your complete privacy and mingle with our other guests in our common areas, when it suits you. This is a fully-furnished studio designed for one person, but the vast majority of couples who have stayed with us find the intimate space cozy. The unit is compact and the bathroom is separated from the rest of the studio by a curtain. Your completely private studio space includes the following: Closet Shelves Desk Lamp Full Sized Bed Refrigerator Microwave Sink Toilet Shower Central Air You also have access to a common area, which includes the following amenities: Rooftop Deck with 360 degree views Fully-Equipped Kitchen Laundry Facilities Dishwasher Iron & Ironing Board Cable Television 100Mbps Wi-Fi Central Air As we value your time and privacy, we offer 24-hour check-in. The process is seamless and doesn't require any scheduling. On the morning of the day of your", "One block from Pike Place Market, the best of Seattle's downtown is at your fingertips in the beautiful Harbor Steps apartments. This unit features 2 Bedroom, 2 Bathroom, is Family Friendly and Handicap Accessible, and Sleeps 6. Free parking, 1 car. UNIT HAS BEEN RENOVATED! FIXTURES ARE UPGRADED. NEW PICTURES COMING SOON! 2 BLOCKS TO PIKE PLACE MARKET AND 1/2 BLOCK TO WATER AND PIERS!!! Live like a local during your stay at the amazing Harbor Steps property located in the heart of downtown Seattle! You'll be a couple blocks away from the famous Pike Place Market and right in the middle of all the action. Experience everything that Seattle has to offer: fantastic dining, vibrant nightlife, and exciting family activities! The Harbor Steps property is located on First avenue, between Seneca and University in the Belltown neighborhood, two blocks from Seattle Waterfront. The property is an easy trip from SEA-TAC airport by car and rail. Harbor Steps: -2 bedrooms with a king bed and a queen", "The Metropolitan Tower property is centrally located on Westlake Avenue, between 6th and 7th. This unit features 2 Bedrooms, 2 Bathrooms, Kitchen, Washer/Dryer, and Sleeps 6.    AMAZING BUILDING, AMENITIES, AND LOCATION WITH A VIEW!!! The Property Who says you can't have it all? This amazing property is located in one of Seattle's best neighborhoods and is only a few blocks from the legendary Pike's Place market and walking distance to many of Seattle's hot spots. Walk over to Safeco Field and Seahawks Stadium, visit the hottest restaurants and bars or take the monorail to Seattle Center and Key arena. Don't worry, you won't navigate living in this gem of a property alone, you will have access to one of our amazing concierges. Perfect Location Our business travelers will enjoy Metro's prime location. The property is situated near UPS and FedEx with many car rental companies located a few minutes away from our vacation rental. Of course, those of us that lead a busy lifestyle still need", "This is a modern fully-furnished studio apartment in a brand new building on Capitol Hill. At Roy Street Commons you can enjoy your complete privacy and mingle with our other guests in our common areas, when it suits you. This is a fully-furnished studio designed for one person, but the vast majority of couples who have stayed with us find the intimate space cozy. The unit is compact and the bathroom is separated from the rest of the studio by a curtain. Your completely private studio space includes the following: Closet Shelves Desk Lamp Full Sized Bed Refrigerator Microwave Sink Toilet Shower Central Air You will also have access to a common area, which includes the following amenities: Rooftop Deck with 360 degree views Fully-Equipped Kitchen Laundry Facilities Dishwasher Iron & Ironing Board Cable Television 100Mbps Wi-Fi Central Air As we value your time and privacy, we offer 24-hour check-in. The process is seamless and doesn't require any scheduling. On the morning of the day of", "One block from Pike Place Market, the best of Seattle's downtown is at your fingertips in the beautiful Harbor Steps apartments. This unit features 2 Bedroom, 2 Bathroom, is Family Friendly and Handicap Accessible, and Sleeps 6. UNIT HAS BEEN RENOVATED! UPDATED PICS COMING SOON! 2 BLOCKS TO PIKE PLACE MARKET AND 1/2 BLOCK TO WATER AND PIERS!!! Live like a local during your stay at the amazing Harbor Steps property located in the heart of downtown Seattle! You'll be a couple blocks away from the famous Pike Place Market and right in the middle of all the action. Experience everything that Seattle has to offer: fantastic dining, vibrant nightlife, and exciting family activities! The Harbor Steps property is located on First avenue, between Seneca and University in the Belltown neighborhood, two blocks from Seattle Waterfront. The property is an easy trip from SEA-TAC airport by car and rail. Harbor Steps: -2 bedrooms with a king bed and a queen bed, and either a pull-out sofa or 2 rollaw", "Built, run and supported by Seattle tech and start up veterans, GrokHome's focus is to create a supportive environment for smart people working on interesting projects, start ups and more. This listing is an upper bunk, in a 4-person shared room. *Note: This fall, there will be major renovations happening on one kitchen and bathroom at a time. There will always be two other working kitchens and two working bathrooms in the house. We'll work to minimize the impact these renovations have on your stay. **This listing is only available to those working in the tech/science space. Live in a hacker house, and immerse yourself in the Seattle tech scene. You can expect to be surrounded by smart people solving big problems or working on something fun. We have frequent demo nights, and love when our guests share something they are passionate about. If you're new to the city, our deep ties to the Seattle tech scene can help you get involved. Expand your network, develop your ideas, and learn somet", "*Clear View of New Year's Eve Space Needle FireWorks* Right at the heart of Seattle's fastest-growing area, this fantastic 1Bed is in belltown a few  blocks away from Pike's Place market and has unobstructed south lake union and space needle views", "Built, run and supported by Seattle tech and start up veterans, GrokHome's focus is to create a supportive environment for smart people working on interesting projects, start ups and more. This listing is an upper bunk, in a 2-person shared room. *Note: This fall, there will be major renovations happening on one kitchen and bathroom at a time. There will always be two other working kitchens and two working bathrooms in the house. We'll work to minimize the impact these renovations have on your stay. **This listing is only available to those working in the tech/science space. Live in a hacker house, and immerse yourself in the Seattle tech scene. You can expect to be surrounded by smart people solving big problems or working on something fun. We have frequent demo nights, and love when our guests share something they are passionate about. If you're new to the city, our deep ties to the Seattle tech scene can help you get involved. Expand your network, develop your ideas, and learn somet", "Via6 is downtown Seattle's hottest new vertical community. This unit has 2 Bedrooms, 2 Bath, Washer & Dryer, Wifi and Sleeps up to 6. The building has a Fitness Center, Movie and Gaming Room, Outdoor Patio and Fantastic Dining on the ground floor. Via6 in Seattle is a brand new property for us, so we will have new photos as soon as possible. Visit our other listings to see how we typically decorate our units and to read our great reviews. Experience downtown Seattle's hottest new vertical community: the amazing Via6. Enjoy everything that Seattle has to offer: fantastic dining, vibrant nightlife, and exciting family activities. The Via6 is a fantastic home base for your perfect Seattle vacation! The Via6 property is centrally located on 6th Avenue between Blanchard and Lenora Streets. Everything you need is within walking distance and Seattle's excellent public transit system makes it easy to explore the city's wonderful neighborhoods. Via6: •2 Bedrooms with a king bed, a queen bed, an"]
neighborhood_overview (object, 2506 distinct): ['Wallingford is a mostly-residential neighborhood, situated between the restaurants, bars and nightlife of Fremont or Ballard, and the buzzing, academic University District.', "Close to downtown, Capitol Hill is one of Seattle's prettiest and most-admired neighborhoods.", 'In the heart of Downtown Seattle! Nearby Attractions:  -Pike Place Market: 2 blocks  -Seattle Art Museum: 2 blocks  -Space Needle: 1.3 miles  -Pacific Science Center: 1.3 miles  -Experience Music Project: 1.3 miles  -Seattle Aquarium: 5 blocks ', 'The Pike/Pine Corridor, recently call "Sesame Street for Grownups" by Seattle Met magazine, has  become one of Seattle\'s most popular and trendy downtown neighborhoods.   It is an eclectic mix of businesses, boutiques, art galleries, restaurants, theaters and pubs.  From our building head west on Pike and you will be in the middle of all that downtown has to offer.  Or stroll east up Pike to discover true Seattle neighborhood culture.  Check out the kitschy shops and pick up a great read at the Elliott Bay bookstore before lunching at Boom Noodle or other favorite neighborhood restaurant.   Don\'t forget to save room for dessert at Cupcake Royal on your way back home.  You will be steps from all the usual Seattle landmarks while immersing yourself in our urban chic Seattle culture.', 'In the heart of Downtown Seattle! Nearby Attractions: -Pike Place Market: 0.5 miles  -Seattle Art Museum: 0.7 miles  -Space Needle: 0.8 miles  -Pacific Science Center: 0.8 miles  -Experience Music Project: 0.8 miles  -Seattle Aquarium: 0.8 miles ', 'This Seward Park neighborhood is a quiet Jewish community just a 1.1mile walk to the Othello light rail station which makes it easy to commute to and from the house.  Also, just a short .8mile walk to Seward Park on Bailey Peninsula in Lake Washington means one can enjoy the natural beauty of Washington from within the city.', 'The University district neighborhood is amazing. Alive with different types of people throughout the year.  A multitude of restaurants and shops plus amazing proximity to downtown Seattle and other popular local neighborhoods.  The North entrance to the University of Washington is just 2 blocks south & University Way is also just 2 blocks west of our location. Super easy public transportation in and out of the area makes the UD a prime location.', 'Experience where Seattle was founded. Explore the historic district full of boutique shops, breweries, restaurants and history. Enjoy the sights and sounds of the Waterfront and the Pike Place Market, all within walking distance.', 'The Capitol Hill neighborhood has a great mix of artisan food and drink, local movie theaters, nightlife and parks. The area is walkable and also can be quickly traveled with public transportation. ', 'Your hosts made Madison Valley their home when settling in Seattle 5 years ago... and haven\'t looked back since. We love walking the streets of this neighborhood, and we will gladly suggest fun walks depending on your interests. Stroll to the beach at Madison Park. Walk by multi-million dollar estates. Discover hidden neighborhood gems such as the farmhouse with horses in the yard and the home that doubles as an eclectic art studio and antique truck gallery. Take a walk through the fabled Arboretum to Lake Washington. Once you have worked up your appetite, enjoy the countless restaurants that Madison Valley ("Little Paris") has to offer. In addition to French gems, try our favorite tapas restaurant or the best Japanese food east of Tokyo. Take your morning coffee in one of numerous bakeries. Or opt for Thai, pan-Asian, craft pizza, Tex-Mex or more. Our home provides easy access to Downtown (Pikes Place Market, Seattle Art Museum, Seattle Great Wheel), Seattle Center (Space Needle, Chih']
notes (object, 1999 distinct): ['All of our rentals are fully licensed and regulated, and maintaining excellent relationships with our building managers is our top priority. We furnish all of our properties to a uniform standard, but individual units may differ slightly from the pictures shown.', 'Should you not be able to book this particular studio, please check our other offerings by clicking on host and then all listings.', "In order to keep a big house clean we have divided cleaning tasks among roommates. In the kitchen is posted our cleaning schedule for all common spaces in the house. We do deep cleans of common spaces twice a week (more if needed/requested) and daily light cleaning. If any cleanliness issues are apparent during your stay please don't hesitate to contact us.  We ask everyone to contribute to the cleanliness of the house and it being welcoming for all by cleaning up after yourself. ", '****This is a shared space in a 4 person room.*****', 'This is a historic property which is listed on the national register of historic locations.', "Ethan is the on site host at Darios' house in the U-DISTRICT near the UW. He works closely with Dario on a daily basis to ensure the most comfortable stay for our guests. Any questions can be directed towards both Ethan or Dario.", 'Is your group larger than this home will accommodate? We can host up to *78* guests across our portfolio --- with all homes located within a few blocks!  We have 1, 2, 3, 4, and 5 bedroom homes all in a very compact area... perfect for large groups, wedding guests, reunions, corporate retreats, etc. To see our full portfolio, click on Andy\'s handsome photo above.  When the new page loads, click Andy\'s photo again to see his full profile.  Try not to be distracted by scores of awesome reviews, and instead scroll down on the left hand side, under "About Me."  Under the "Listings" header, click on "view all listings." The full portfolio includes: **Thomas Lodge Vermont: 1 bedroom/1 bathroom (sleeps 2-4) **Thomas Lodge Boston: 2 bedrooms/2 bathrooms (sleeps 4-6) **Thomas Lodge Philadelphia: 1 bedroom/1 bathroom (sleeps 2-4) **Thomas Lodge New York: 2 bedrooms/2 bathrooms (sleeps 4-6) (All of the above represent the entirety of a 4-plex building; sleeps up to 20) **House of Suffrage: 4 bedr', 'Allessandro is the on site host at the house near Seward Park. He works closely with Dario on a daily basis to ensure the most comfortable stay for our guests. Any questions can be directed towards both Allessandro or Dario.', '****This is a shared space in a 2 person room.*****', 'Ethan is the on site host at the house near UW. He works closely with Dario on a daily basis to ensure the most comfortable stay for our guests. Any questions can be directed towards both Ethan or Dario.']
transit (object, 2574 distinct): ['Convenient public transportation. The locations of our properties are ideal for guests who prefer to travel without a car.', '(URL HIDDEN)', 'Our house sits directly on the Burke Gilman Trail, and we provide bikes, helmets and locks available for loan. 4 blocks away is a bus stop that will take you directly downtown or to the University District.', "It's a short walk to Broadway and just a bit longer to downtown. There is a Pronto bike share 100 yards away.  There is a bus stop for downtown 300 yards away.", "There's tons of easy public transportation around - we are within 1 block of 8 different bus lines, and within a few blocks of a handful more. It is easy to get here from the airport using public transportation for part or all of the way by taking the light rail train to downtown and then going the remaining half mile either by transferring to a bus, taxi, or just walking (we are about a 20 minute walk from Westlake Station).  To incentivise people not to drive, we have a deal with Über, a taxi alternative car company, for $20 off your first ride for new users; see the card in the handbook in the unit for the promo code! We are in a dense part of the city and recommend against renting a car if you're on the fence about it, as driving and parking is a headache in Seattle's traffic and there are so many easy alternatives. However, some people have to drive, and for them, we do have parking spots available behind our building. Parking is not included in the rate; let us know if you would ", 'CONVENIENT PUBLIC TRANSPORTATION! WALKING DISTANCE TO POPULAR DOWNTOWN ATTRACTIONS! 1 space per apartment is available in the underground garage with controlled access. No assigned spots Clearance: 6.5 feet Additional Parking: Public parking allowed in same garage, metered parking on the street, and other surrounding parking garages.', "We live a few short blocks from bus lines that will take you to Seattle's numerous neighborhoods (Madison Park, Capitol Hill, Downtown, Belltown, Seattle Center, South Lake Union). Queen Anne, Ballard, and Fremont are more easily accessed by car. Our home offers garage parking for one car. Street parking for additional cars is plentiful and free.", 'If you come from the airport, you may either take the cab or take the link (train) to downtown Seattle. Then take the bus 71,72,73 to U district. Our place is just a couple blocks from the 25th ave where the University Village Shopping Center is, there are many bus lines to literally take you to anywhere in Seattle.', 'Right at the corner of Brooklyn Ave and 45th st, there are many bus lines are just a few steps away and can take you anywhere in Seattle. There are 130 restaurants within a 15 minute walk including BBQ Chicken, Mongolian Grill, Thai Food, Japanese Noodle, Greek Gyro and Bubble tea house, etc.  Coming from the airport, you either take a taxi (around $60) or an airport shuttle and tell them to get off at "Hotel Deca" that will make your rate cheaper for the drivers drop passengers at that hotel often, our place is on the same street within 25 feet. Or you can take the link to downtown and bus to here near 45th st NE and NE Brooklyn Ave.', 'There are a multitude of ways to travel to our location; easiet; drive, UBER or taxi  (parking is through the alley behind the house.) * FROM AIRPORT* - rental car or taxi (no uber) - light rail to downtow(URL HIDDEN)(convention center stop within tunnel) - transfer to bus:(#72, #72x, or other) (depending on day & time) - depart bus within just a few blocks of our location no matter which bus you take. All busses to downtown take only 10-15min depending on traffic. The trip by car from the airport can take 30-60min depending on traffic if you drive. The light rail takes about 30min to reach downtown from the airport.']
host_name (object, 1466 distinct): ['Andrew', 'Jordan', 'Daniela', 'Michael', 'Melissa', 'Sea To Sky Rentals', 'Darik', 'Chris', 'Eric', 'Lisa']
host_since (datetime64[ns], 0 distinct): ['2013-08-30 00:00:00', '2013-02-04 00:00:00', '2011-10-03 00:00:00', '2011-03-08 00:00:00', '2012-07-27 00:00:00', '2010-01-27 00:00:00', '2015-08-25 00:00:00', '2015-01-30 00:00:00', '2013-07-08 00:00:00', '2013-03-04 00:00:00']
host_location (object, 120 distinct): ['Seattle, Washington, United States', 'US', 'Spokane, Washington, United States', 'Kent, Washington, United States', 'Los Angeles, California, United States', 'Bellevue, Washington, United States', 'San Francisco, California, United States', 'Mercer Island, Washington, United States', 'Kirkland, Washington, United States', 'New York, New York, United States']
host_about (object, 2011 distinct): ['It would be my pleasure to share and explore this wonderful city with you!', 'Stay Alfred was created based on the idea of offering short term rentals at an unbelievable price while making the booking process easy and problem free. Stay Alfred acquires properties in high end buildings and condominiums in the best locations to ensure your stay is satisfying and you want to come back. Since we value your return business, we always offer discounts to those who stay in any of our units time after time. We want you to feel at home when you stay with us and that’s why you will always be greeted with a professionally cleaned unit and quality furnishings. We welcome feedback in any kind of way to ensure we are meeting the needs of everyone!\r\n\r\nWe cater to:\r\n\r\nUrban Vacations\r\nFamily Travel\r\nCorporate Housing\r\nExtended stay In Denver, Seattle, Bellevue, Spokane, and Portland\r\nInsurance and Job Relocation\r\nEvents and Weddings \r\nMilitary Training and PCS\r\nGovernment Workers\r\nPet Friendly Vacationers', "I develop technology businesses, including CityAuction, a  local-oriented online auction I started in 1997, and Pure Watercraft, a high-performance electric boating company I started in 2011. I've also been an angel investor since 2000.\r\n\r\nAs a TechStars mentor, I've seen the difficulty that teams have when they seek short-term housing while in Seattle. I've also seen the incredibly creative atmosphere that has been created in the hacker houses of other areas, such as Chez JJ in the SF Bay Area. My goal is to cultivate an even more vibrant, fun, and creative tech community here in Seattle.", 'Rental and Management company representing over 30 properties in Seattle, Washington!', 'Used to be a professor (Ph.D. in Political Economy), then a homeschooling mom and  a religious non profit organization founder, now like to travel, read / review books and manage properties. The best cities I like are Seattle, Florence, Sanya and Taipei.  (Taipei is chosen as the #1 out of 26 Remarkable Places For Solo Travel by BuzzFeed!  (website hidden)) We have  a few nicely furnished studios and one bedrooms condo apt conveniently located near University of Washington in Seattle with your own private kitchen and bathroom.  You will enjoy the convenient locations and quietness of all these buildings. You will also be surprised how quickly we respond to your requests as long as I am in town.  My motto is Providing Quality Places at Fair Prices and my life motto is in Philippians 4:13. ', "My wife, Sally and I are excited for you to stay with us!  We originally purchased a condo in Belltown to use as a second home in the winter of 2007.\r\n\r\nBecause of our nack at hosting, great marketing, amazing design, what was just an investment, has become a full time business.  We currently have 35 properties in the heart of Downtown Seattle that we either own or manage on the behalf of others.\r\n\r\nSally is an interior designer by trade, and I'm sure you'll be able to tell when it comes to the quality items to help you feel comfortable while you are staying with us.\r\n\r\nWe take our position as hosts very seriously.  Our condos are cleaned immaculately and have the best staff in the business.  We are both foodies, and welcome the ability to share with you the best places in the city!\r\n\r\nThanks, and we look forward to hosting you!", 'Welcome, my name is Dario.\r\n\r\nI was born in Sicily and I moved to Seattle eight years ago. I am an Italian teacher and the director of Boys Tribe Project, an after school program to help boys develop emotional intelligence, learn how to play rough without hurting each other, and be creative with imaginative play and storytelling.\r\n\r\nI love to cook Italian homemade food, traveling, personal growth, psychology, jazz and blues, foreign movies, interior design, modern dance, storytelling, art, and culture in general. I love hosting people, I used to host couch surfers and I also was traveling for a few years. The thing I like the most is to hear and to share stories from people all over the world.', 'We are a roommate duo (Leah and Mike!) who have lived together for a number of years! We make music, do science, design the internet, social work, and drink cheap beer.', 'Addicted renovator of homes.  Love helping people enjoy the awesome City of Seattle.', "Cherie and I are Seattle Natives with a taste for the world. We love LA, NY, MIA and all in between, but Seattle is our city. We are small business owners and thought Airbnb would be an interesting new venture at a less stressful pace.  We are very casual after business hours :) and a very social couple.  We enjoy meeting people from different cultures and love to entertain.\r\n\r\nPrez:  I have been blessed with opportunities to travel many places (or at least many places to us), love new experiences and seeing historic land marks. We take pride in our city's beauty, rich culture and past good or bad.\r\n\r\nI've worked for myself most of my life and love being creative . I enjoy graphic design, acting rapping, video production, editing, directing, ballin' and shot callin' (a little urban humor) LOL. I truly want to do everything. I was a volunteer fire fighter with the Seattle Fire Department, EMT and certified life guard. ( I told you I want to do everything)\r\n\r\nI have a lot of day activity and nightlife connections with the transportation company I manage, if you want to do a little exploring- we've got the hook up.  We like to let our guests determine if they want some private personal time while using our space or want the works with sight seeing suggestions and even the option of tagging along with us for some fun. (Warning it can get a little crazy with us, especially once the party bus gets rolling, lol ). It is very common to see buses coming or going from our property at various hours of the day and night.  You can book airport / train / bus pick ups and drop off'(email hidden), please enter airbnb as the referral to receive a discount.\r\n\r\nWe are open to any and all guests as along as everyone is respectful and polite.  Your race, sexual preference or religion is respected as long as you extend the same respect. Our space has its own keyless entry so you're welcome to come and go as you please without worrying about disturbing the rest of the house. \r\n\r\nI hope to have you stay with us...check out our reviews and book a night!\r\n\r\nPS: THIS IS NOT A 5 STAR HOTEL, WHATS IN THE PHOTOS IS IN THE HOUSE. \r\n\r\nPrez & Cherie\r\n"]
host_response_time (object, 4 distinct): ['within an hour', 'within a few hours', 'within a day', 'a few days or more']
host_response_rate (float64, 45 distinct): ['100.0', '90.0', '80.0', '99.0', '88.0', '50.0', '94.0', '67.0', '75.0', '89.0']
host_acceptance_rate (float64, 2 distinct): ['100.0', '0.0']
host_is_superhost (object, 2 distinct): ['f', 't']
host_neighbourhood (object, 102 distinct): ['Capitol Hill', 'Belltown', 'Ballard', 'Minor', 'Queen Anne', 'Fremont', 'Wallingford', 'North Beacon Hill', 'Ravenna', 'Central Business District']
host_listings_count (float64, 27 distinct): ['1.0', '2.0', '3.0', '4.0', '5.0', '34.0', '6.0', '48.0', '169.0', '37.0']
host_total_listings_count (float64, 27 distinct): ['1.0', '2.0', '3.0', '4.0', '5.0', '34.0', '6.0', '48.0', '169.0', '37.0']
host_verifications (object, 115 distinct): ["['email', 'phone', 'facebook', 'reviews', 'kba']", "['email', 'phone', 'reviews', 'kba']", "['email', 'phone', 'reviews']", "['email', 'phone', 'facebook', 'reviews', 'jumio']", "['email', 'phone', 'reviews', 'jumio']", "['email', 'phone', 'facebook', 'reviews']", "['email', 'phone', 'facebook', 'linkedin', 'reviews', 'jumio']", "['email', 'phone', 'facebook', 'linkedin', 'reviews', 'kba']", "['email', 'phone', 'linkedin', 'reviews', 'jumio']", "['email', 'phone', 'linkedin', 'reviews', 'kba']"]
host_has_profile_pic (object, 2 distinct): ['t', 'f']
host_identity_verified (object, 2 distinct): ['t', 'f']
street (object, 1442 distinct): ['1st Avenue, Seattle, WA 98101, United States', 'Hubbell Place, Seattle, WA 98101, United States', '12th Avenue East, Seattle, WA 98102, United States', 'East Denny Way, Seattle, WA 98122, United States', '10th Avenue East, Seattle, WA 98102, United States', '1st Avenue, Seattle, WA 98121, United States', 'Queen Anne Avenue North, Seattle, WA 98109, United States', 'Boylston Avenue East, Seattle, WA 98102, United States', 'Summit Avenue East, Seattle, WA 98102, United States', '2nd Avenue, Seattle, WA 98121, United States']
neighbourhood (object, 81 distinct): ['Capitol Hill', 'Ballard', 'Belltown', 'Minor', 'Queen Anne', 'Fremont', 'Wallingford', 'University District', 'First Hill', 'Stevens']
neighbourhood_cleansed (object, 87 distinct): ['Broadway', 'Belltown', 'Wallingford', 'Fremont', 'Minor', 'University District', 'Stevens', 'First Hill', 'Central Business District', 'Lower Queen Anne']
neighbourhood_group_cleansed (object, 17 distinct): ['Other neighborhoods', 'Capitol Hill', 'Downtown', 'Central Area', 'Queen Anne', 'Ballard', 'West Seattle', 'Rainier Valley', 'University District', 'Beacon Hill']
city (object, 7 distinct): ['Seattle', 'West Seattle', 'Seattle ', 'Ballard, Seattle', '西雅图', 'Phinney Ridge Seattle', 'seattle']
state (object, 2 distinct): ['WA', 'wa']
zipcode (object, 28 distinct): ['98122', '98103', '98102', '98105', '98109', '98101', '98144', '98121', '98107', '98115']
smart_location (object, 7 distinct): ['Seattle, WA', 'West Seattle, WA', 'Seattle , WA', 'Ballard, Seattle, WA', '西雅图, WA', 'Phinney Ridge Seattle, WA', 'seattle, wa']
latitude (float64, 3818 distinct): ['47.6363', '47.6391', '47.6297', '47.6385', '47.6329', '47.6305', '47.6366', '47.6402', '47.6324', '47.6375']
longitude (float64, 3818 distinct): ['-122.371', '-122.3657', '-122.3695', '-122.3693', '-122.3725', '-122.3662', '-122.3685', '-122.3759', '-122.3572', '-122.3669']
is_location_exact (object, 2 distinct): ['t', 'f']
property_type (object, 16 distinct): ['House', 'Apartment', 'Townhouse', 'Condominium', 'Loft', 'Bed & Breakfast', 'Other', 'Cabin', 'Camper/RV', 'Bungalow']
room_type (object, 3 distinct): ['Entire home/apt', 'Private room', 'Shared room']
accommodates (int64, 15 distinct): ['2', '4', '3', '6', '1', '5', '8', '7', '10', '12']
bathrooms (float64, 12 distinct): ['1.0', '2.0', '1.5', '2.5', '3.0', '3.5', '0.5', '4.0', '0.0', '4.5']
bedrooms (float64, 8 distinct): ['1.0', '2.0', '0.0', '3.0', '4.0', '5.0', '6.0', '7.0']
beds (float64, 11 distinct): ['1.0', '2.0', '3.0', '4.0', '5.0', '6.0', '7.0', '8.0', '9.0', '10.0']
bed_type (object, 5 distinct): ['Real Bed', 'Futon', 'Pull-out Sofa', 'Airbed', 'Couch']
amenities (object, 3284 distinct): ['{}', '{Internet,"Wireless Internet",Kitchen,"Free Parking on Premises",Heating,Washer,Dryer}', '{TV,"Cable TV",Internet,"Wireless Internet",Pool,Kitchen,"Free Parking on Premises",Gym,"Elevator in Building","Hot Tub",Heating,"Family/Kid Friendly",Washer,Dryer,"Smoke Detector","Carbon Monoxide Detector","Fire Extinguisher",Essentials,Shampoo,"24-Hour Check-in",Hangers,"Hair Dryer",Iron}', '{TV,"Cable TV",Internet,"Wireless Internet",Kitchen,"Buzzer/Wireless Intercom",Heating,Washer,Dryer,Essentials,"24-Hour Check-in",Hangers,"Hair Dryer",Iron,"Laptop Friendly Workspace"}', '{TV,Internet,"Wireless Internet","Air Conditioning","Wheelchair Accessible",Kitchen,Doorman,Gym,"Elevator in Building","Buzzer/Wireless Intercom",Heating,"Family/Kid Friendly",Washer,Dryer,"Smoke Detector","Carbon Monoxide Detector","First Aid Kit","Safety Card","Fire Extinguisher",Essentials,Shampoo,"24-Hour Check-in",Hangers,"Hair Dryer",Iron,"Laptop Friendly Workspace"}', '{Internet,"Wireless Internet",Kitchen,Heating,"Suitable for Events",Washer,Dryer,"Smoke Detector","Carbon Monoxide Detector","First Aid Kit","Fire Extinguisher",Essentials}', '{TV,Internet,"Wireless Internet","Air Conditioning",Kitchen,"Free Parking on Premises",Heating,Washer,Dryer,"Smoke Detector","Carbon Monoxide Detector","First Aid Kit","Fire Extinguisher",Essentials,Shampoo}', '{TV,"Cable TV",Internet,"Wireless Internet","Air Conditioning",Kitchen,"Buzzer/Wireless Intercom",Heating,"Family/Kid Friendly",Washer,Dryer,"Smoke Detector","Carbon Monoxide Detector","First Aid Kit","Fire Extinguisher",Essentials,Shampoo}', '{TV,"Cable TV",Internet,"Wireless Internet","Wheelchair Accessible",Kitchen,"Free Parking on Premises",Gym,"Elevator in Building","Buzzer/Wireless Intercom",Heating,"Family/Kid Friendly",Washer,Dryer,"Smoke Detector","Carbon Monoxide Detector","Safety Card","Fire Extinguisher",Essentials,Shampoo,Hangers,"Hair Dryer",Iron}', '{TV,"Cable TV",Internet,"Wireless Internet",Kitchen,"Free Parking on Premises",Heating,"Family/Kid Friendly",Washer,Dryer,"Smoke Detector","Carbon Monoxide Detector","First Aid Kit","Safety Card","Fire Extinguisher",Essentials,Shampoo}']
square_feet (float64, 47 distinct): ['1200.0', '800.0', '1300.0', '0.0', '650.0', '750.0', '500.0', '250.0', '1000.0', '1.0']
guests_included (int64, 15 distinct): ['1', '2', '4', '0', '3', '6', '5', '8', '7', '10']
minimum_nights (int64, 22 distinct): ['1', '2', '3', '4', '5', '7', '14', '6', '20', '30']
maximum_nights (int64, 68 distinct): ['1125', '30', '365', '14', '7', '90', '60', '10', '180', '29']
calendar_updated (object, 34 distinct): ['today', '2 weeks ago', '3 weeks ago', '2 months ago', 'a week ago', 'yesterday', '3 months ago', '4 weeks ago', '3 days ago', '5 weeks ago']
availability_30 (int64, 31 distinct): ['30', '0', '29', '25', '27', '26', '28', '20', '23', '21']
availability_60 (int64, 61 distinct): ['60', '0', '59', '57', '55', '56', '53', '52', '50', '58']
availability_90 (int64, 91 distinct): ['90', '0', '89', '85', '88', '87', '83', '86', '84', '82']
availability_365 (int64, 363 distinct): ['365', '0', '364', '89', '361', '358', '362', '359', '363', '357']
number_of_reviews (int64, 195 distinct): ['0', '1', '2', '4', '3', '5', '6', '7', '10', '12']
first_review (datetime64[ns], 0 distinct): ['2015-09-21 00:00:00', '2015-12-01 00:00:00', '2015-07-27 00:00:00', '2015-06-14 00:00:00', '2015-08-31 00:00:00', '2015-11-29 00:00:00', '2015-08-23 00:00:00', '2015-08-30 00:00:00', '2015-09-07 00:00:00', '2015-08-16 00:00:00']
last_review (datetime64[ns], 0 distinct): ['2016-01-02 00:00:00', '2015-11-29 00:00:00', '2015-12-01 00:00:00', '2016-01-01 00:00:00', '2015-12-30 00:00:00', '2015-12-20 00:00:00', '2015-12-29 00:00:00', '2015-12-28 00:00:00', '2015-12-31 00:00:00', '2015-12-21 00:00:00']
review_scores_rating (float64, 42 distinct): ['100.0', '98.0', '96.0', '97.0', '95.0', '94.0', '93.0', '99.0', '90.0', '80.0']
review_scores_accuracy (float64, 7 distinct): ['10.0', '9.0', '8.0', '6.0', '7.0', '4.0', '2.0']
review_scores_cleanliness (float64, 8 distinct): ['10.0', '9.0', '8.0', '7.0', '6.0', '5.0', '4.0', '3.0']
review_scores_checkin (float64, 8 distinct): ['10.0', '9.0', '8.0', '7.0', '6.0', '4.0', '2.0', '5.0']
review_scores_communication (float64, 8 distinct): ['10.0', '9.0', '8.0', '6.0', '7.0', '4.0', '2.0', '5.0']
review_scores_location (float64, 6 distinct): ['10.0', '9.0', '8.0', '7.0', '6.0', '4.0']
review_scores_value (float64, 8 distinct): ['10.0', '9.0', '8.0', '7.0', '6.0', '4.0', '2.0', '5.0']
instant_bookable (object, 2 distinct): ['f', 't']
cancellation_policy (object, 3 distinct): ['strict', 'moderate', 'flexible']
require_guest_profile_picture (object, 2 distinct): ['f', 't']
require_guest_phone_verification (object, 2 distinct): ['f', 't']
calculated_host_listings_count (int64, 18 distinct): ['1', '2', '3', '4', '5', '6', '37', '31', '34', '11']
reviews_per_month (float64, 654 distinct): ['1.0', '2.0', '0.23', '0.81', '0.36', '0.16', '0.26', '0.53', '0.37', '0.3']
house_image (object, 2864 distinct): ['', 'https___a1.muscache.com_ac_pictures_91267375_b7f59fa9_original.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70', 'https___a0.muscache.com_ac_pictures_63897187_da1e8b42_original.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70', 'https___a1.muscache.com_ac_pictures_45422466_7450389d_original.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70', 'https___a0.muscache.com_ac_pictures_21578378_74b31253_original.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70', 'https___a2.muscache.com_ac_pictures_5a1c7f83-a2ee-43c3-b457-056b0a080bdd.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70', 'https___a1.muscache.com_ac_pictures_81340467_9aef56bb_original.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70', 'https___a2.muscache.com_ac_pictures_56819435_c4575828_original.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70', 'https___a1.muscache.com_ac_pictures_109210844_61e34bb9_original.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70', 'https___a1.muscache.com_ac_pictures_94837477_bf30ef09_original.jpg?interpolation=lanczos-none&size=large_cover&output-format=jpg&output-quality=70']
host_image (object, 2066 distinct): ['', 'https___a2.muscache.com_ac_users_430709_profile_pic_1407448665_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70', 'https___a2.muscache.com_ac_users_3074414_profile_pic_1408093668_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70', 'https___a0.muscache.com_ac_users_74305_profile_pic_1264620605_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70', 'https___a1.muscache.com_ac_users_7354306_profile_pic_1373649588_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70', 'https___a2.muscache.com_ac_users_658155_profile_pic_1307117042_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70', 'https___a2.muscache.com_ac_users_2911360_profile_pic_1394702750_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70', 'https___a2.muscache.com_ac_users_862329_profile_pic_1379540383_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70', 'https___a1.muscache.com_ac_users_754810_profile_pic_1411760358_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70', 'https___a2.muscache.com_ac_users_14980831_profile_pic_1398993662_original.jpg?interpolation=lanczos-none&crop=w_w;*,*&crop=h_h;*,*&resize=225_*&output-format=jpg&output-quality=70']
'''

def load_df(dir_path: str) -> DataFrame:
    df_path = join(dir_path, 'listings.csv')
    df = read_csv(df_path)
    img_folder = join(dir_path, IMAGE_FOLDER)
    df = get_house_image(df=df, img_folder=img_folder)
    df = get_host_image(df=df, img_folder=img_folder)
    return df


def get_house_image(df: DataFrame, img_folder: str) -> DataFrame:
    house_img_cols = ['picture_url', 'thumbnail_url', 'medium_url', 'xl_picture_url']
    for house_img_col in house_img_cols:
        df = download_url_image_column(df=df, img_folder=img_folder, img_col=house_img_col)
    df['house_image'] = df.apply(lambda r: take_first_pic(r, cols=house_img_cols), axis=1)
    df.drop(columns=house_img_cols, inplace=True)
    return df

def get_host_image(df: DataFrame, img_folder: str) -> DataFrame:
    host_img_cols = ['host_picture_url', 'host_thumbnail_url']
    for host_img_col in host_img_cols:
        df = download_url_image_column(df=df, img_folder=img_folder, img_col=host_img_col)
    df['host_image'] = df.apply(lambda r: take_first_pic(r, cols=host_img_cols), axis=1)
    df.drop(columns=host_img_cols, inplace=True)
    return df

def extract_price(s: str) -> float:
    # Currency looks like '$50.00'
    if isinstance(s, float):
        return s
    try:
        s = s.replace('$', '').replace(',', '')
        return float(s)
    except:
        assert False, f"What is the percentage? {s} from type {type(s)}"

def extract_percentage(s: str) -> float:
    # Percentage looks like '100%'
    if isinstance(s, float):
        return s
    s = s.replace('%', '')
    try:
        return float(s)
    except:
        assert False, f"What is the percentage? {s} from type {type(s)}"

def take_first_pic(row: Series, cols: List[str]) -> str:
    for c in cols:
        v = row[c]
        if v:
            return v
    return None


CONTEXT = "AirBnB Seattle Listing during 2026"
TARGET = CuratedTarget(raw_name="price", task_type=SupervisedTask.REGRESSION, processing_func=extract_price)
FEATURES = [CuratedFeature(raw_name='house_image', feat_type=FeatureType.IMAGE),
            CuratedFeature(raw_name='host_image', feat_type=FeatureType.IMAGE),
            CuratedFeature(raw_name='first_review', feat_type=FeatureType.DATE),
            CuratedFeature(raw_name='last_review', feat_type=FeatureType.DATE),
            CuratedFeature(raw_name='host_since', feat_type=FeatureType.DATE),
            CuratedFeature(raw_name='host_response_rate', processing_func=extract_percentage),
            CuratedFeature(raw_name='host_acceptance_rate', processing_func=extract_percentage),
           ]

COLS_TO_DROP = [
# IDs
'id', 'host_id',
# Constants
'calendar_last_scraped', 'has_availability', 'scrape_id', 'last_scraped', 'experiences_offered', 'market',
'country_code', 'country', 'requires_license', 'license', 'jurisdiction_names',
# Irrelevant - Links to websites
'listing_url', 'host_url',
# Leakage
'weekly_price', 'monthly_price', 'security_deposit', 'cleaning_fee', 'extra_people',
]

IMAGE_FOLDER = "downloaded_images"
LOADING_FUNC = load_df
PROCESSING_FUNC = None
